<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ç¬¬ 372 åœºå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/11/19/weekly-contest-372/"/>
      <url>/2023/11/19/weekly-contest-372/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>ä¸€å¼€å§‹çœ‹åˆ° T3 æ˜¯å¼‚æˆ–å¿ƒé‡Œå¤§å–œï¼Œåˆæ˜¯å­—å…¸æ ‘ï¼Œå¥½å®¶ä¼™åˆšæ€»ç»“è¿‡æ¿å­ç›´æ¥å¤åˆ¶è¿‡æ¥ï¼Œä»”ç»†çœ‹å®Œé¢˜å‘ç°ä¸æ˜¯ç›´æ¥ GGã€‚T4 ç”¨ç¦»çº¿åŠ æœ€å°å †å†™å‡ºæ¥äº†å¹¶ä¼˜åŒ–äº†å¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯ä¾æ—§è¶…æ—¶è¿‡ä¸äº†ï¼Œè¿˜æ˜¯æ²¡åˆ†æå¥½ï¼Œåˆæ˜¯ä¸¤é¢˜çš„ä¸€å‘¨ã€‚</p><p><img src="https://s2.loli.net/2023/11/19/eyhmsgNaFTwDMiq.png"></p><h5 id="T1-ä½¿ä¸‰ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰"><a href="#T1-ä½¿ä¸‰ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰" class="headerlink" title="T1. ä½¿ä¸‰ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰"></a><a href="https://leetcode.cn/contest/weekly-contest-372/problems/make-three-strings-equal/">T1. ä½¿ä¸‰ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰</a></h5><p>å°±æ˜¯æ±‚ä¸‰ä¸ªå­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findMinimumOperations</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">,</span> <span class="token class-name">String</span> s3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s3<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> s2<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> s1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> s3<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> s1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> s3<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T2-åŒºåˆ†é»‘çƒä¸ç™½çƒ"><a href="#T2-åŒºåˆ†é»‘çƒä¸ç™½çƒ" class="headerlink" title="T2. åŒºåˆ†é»‘çƒä¸ç™½çƒ"></a><a href="https://leetcode.cn/contest/weekly-contest-372/problems/separate-black-and-white-balls/">T2. åŒºåˆ†é»‘çƒä¸ç™½çƒ</a></h5><p>ä¼¼æ›¾ç›¸è¯†çš„é¢˜ï¼Œå¯ä»¥è½¬åŒ–ä¸ºæ±‚æ¯ä¸ª 0 å‰é¢çš„ 1 çš„ä¸ªæ•°ï¼Œåˆå› ä¸ºæ²¡å†™ long ç±»å‹ wa äº†ä¸€å‘</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">minimumSteps</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cnt1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> s<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token char">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cnt1<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">+=</span> cnt1<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-æœ€å¤§å¼‚æˆ–ä¹˜ç§¯"><a href="#T3-æœ€å¤§å¼‚æˆ–ä¹˜ç§¯" class="headerlink" title="T3. æœ€å¤§å¼‚æˆ–ä¹˜ç§¯"></a><a href="https://leetcode.cn/contest/weekly-contest-372/problems/maximum-xor-product/">T3. æœ€å¤§å¼‚æˆ–ä¹˜ç§¯</a></h5><p>å·¨ä½¬ O(1) çš„ä»£ç ï¼Œä¼˜é›…</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximumXorProduct</span><span class="token punctuation">(</span><span class="token keyword">long</span> a<span class="token punctuation">,</span> <span class="token keyword">long</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// ä¿è¯ a >= b</span>            <span class="token keyword">long</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span>            a <span class="token operator">=</span> b<span class="token punctuation">;</span>            b <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1L</span> <span class="token operator">&lt;&lt;</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> ax <span class="token operator">=</span> a <span class="token operator">&amp;</span> <span class="token operator">~</span>mask<span class="token punctuation">;</span> <span class="token comment">// ç¬¬ n ä½åŠå…¶å·¦è¾¹ï¼Œæ— æ³•è¢« x å½±å“ï¼Œå…ˆç®—å‡ºæ¥</span>        <span class="token keyword">long</span> bx <span class="token operator">=</span> b <span class="token operator">&amp;</span> <span class="token operator">~</span>mask<span class="token punctuation">;</span>        a <span class="token operator">&amp;=</span> mask<span class="token punctuation">;</span> <span class="token comment">// ä½äºç¬¬ n ä½ï¼Œèƒ½è¢« x å½±å“</span>        b <span class="token operator">&amp;=</span> mask<span class="token punctuation">;</span>        <span class="token keyword">long</span> left <span class="token operator">=</span> a <span class="token operator">^</span> b<span class="token punctuation">;</span> <span class="token comment">// å¯åˆ†é…ï¼ša XOR x å’Œ b XOR x ä¸€ä¸ªæ˜¯ 1 å¦ä¸€ä¸ªæ˜¯ 0</span>        <span class="token keyword">long</span> one <span class="token operator">=</span> mask <span class="token operator">^</span> left<span class="token punctuation">;</span> <span class="token comment">// æ— éœ€åˆ†é…ï¼ša XOR x å’Œ b XOR x å‡ä¸º 1</span>        ax <span class="token operator">|=</span> one<span class="token punctuation">;</span> <span class="token comment">// å…ˆåŠ åˆ°å¼‚æˆ–ç»“æœä¸­</span>        bx <span class="token operator">|=</span> one<span class="token punctuation">;</span>        <span class="token comment">// ç°åœ¨è¦æŠŠ left åˆ†é…åˆ° ax å’Œ bx ä¸­</span>        <span class="token comment">// æ ¹æ®åŸºæœ¬ä¸ç­‰å¼ï¼ˆå‡å€¼å®šç†ï¼‰ï¼Œåˆ†é…ååº”å½“ä½¿ ax å’Œ bx å°½é‡æ¥è¿‘ï¼Œä¹˜ç§¯æ‰èƒ½å°½é‡å¤§</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> ax <span class="token operator">==</span> bx<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å°½é‡å‡åŒ€åˆ†é…ï¼Œä¾‹å¦‚æŠŠ 1111 åˆ†æˆ 1000 å’Œ 0111</span>            <span class="token keyword">long</span> highBit <span class="token operator">=</span> <span class="token number">1L</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">63</span> <span class="token operator">-</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">numberOfLeadingZeros</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ax <span class="token operator">|=</span> highBit<span class="token punctuation">;</span>            left <span class="token operator">^=</span> highBit<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¦‚æœ a &amp; ~mask æ›´å¤§ï¼Œåˆ™åº”å½“å…¨éƒ¨åˆ†ç»™ bxï¼ˆæ³¨æ„æœ€ä¸Šé¢ä¿è¯äº† a>=bï¼‰</span>        bx <span class="token operator">|=</span> left<span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">MOD</span> <span class="token operator">=</span> <span class="token number">1_000_000_007</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>ax <span class="token operator">%</span> <span class="token constant">MOD</span> <span class="token operator">*</span> <span class="token punctuation">(</span>bx <span class="token operator">%</span> <span class="token constant">MOD</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token constant">MOD</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ³¨æ„ä¸èƒ½ç›´æ¥ long * longï¼Œå¦åˆ™æº¢å‡º</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T4-æ‰¾åˆ°-Alice-å’Œ-Bob-å¯ä»¥ç›¸é‡çš„å»ºç­‘"><a href="#T4-æ‰¾åˆ°-Alice-å’Œ-Bob-å¯ä»¥ç›¸é‡çš„å»ºç­‘" class="headerlink" title="T4. æ‰¾åˆ° Alice å’Œ Bob å¯ä»¥ç›¸é‡çš„å»ºç­‘"></a><a href="https://leetcode.cn/contest/weekly-contest-372/problems/find-building-where-alice-and-bob-can-meet/">T4. æ‰¾åˆ° Alice å’Œ Bob å¯ä»¥ç›¸é‡çš„å»ºç­‘</a></h5><p>ç¦»æ•£ + æœ€å°å †çš„è§£æ³•ï¼Œå…ˆå¤„ç† <code>heights[i] &lt; heights[j]</code> çš„ï¼Œå†å°† <code>heights[i] &gt;= heights[j]</code> çš„æƒ…å†µè®°å½•ä¸‹æ¥ï¼Œç”¨æœ€å°å †ç»´æŠ¤è®°å½•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">leftmostBuildingQueries</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heights<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>queries<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">[</span>heights<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">setAll</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> e <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> qi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> qi <span class="token operator">&lt;</span> queries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> qi<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> i <span class="token operator">=</span> queries<span class="token punctuation">[</span>qi<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> j <span class="token operator">=</span> queries<span class="token punctuation">[</span>qi<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>                i <span class="token operator">=</span> j<span class="token punctuation">;</span>                j <span class="token operator">=</span> temp<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> j <span class="token operator">||</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans<span class="token punctuation">[</span>qi<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                left<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> qi<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> pq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> heights<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> h <span class="token operator">=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>pq<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> pq<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> h<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans<span class="token punctuation">[</span>pq<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p <span class="token operator">:</span> left<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                pq<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰è¶£çš„è¿æ¥å¤ç”¨</title>
      <link href="/2023/11/13/research-okhttp-connection-pool/"/>
      <url>/2023/11/13/research-okhttp-connection-pool/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>okhttp ä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½çš„ç½‘ç»œè¯·æ±‚å®¢æˆ·ç«¯ï¼Œåœ¨è®¾è®¡ä¸Šæœ‰è®¸å¤šå¯ä»¥å­¦ä¹ çš„åœ°æ–¹ï¼Œæœ¬ç¯‡ä¸è®¨è®ºåˆ†å‘å™¨ dispatcher å’Œæ‹¦æˆªå™¨ intercerptor çš„å®ç°ï¼Œè€Œåœ¨æºç ä¸Šåˆ†ææˆ‘è®¤ä¸ºæœ€é‡è¦çš„æ¨¡å—ä¹Ÿå°±æ˜¯è¿æ¥æ± çš„å®ç°ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼ŒTCP è¿æ¥çš„å»ºç«‹å’Œæ–­å¼€éœ€è¦ç»å†ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹ï¼Œå¯¹ä¸šåŠ¡æ¥è¯´æ˜¯æ— æ•ˆè€—æ—¶ï¼Œå¹¶ä¸”è€—æ—¶å¹¶ä¸å°ï¼Œå³ä¾¿åœ¨ HTTP&#x2F;1.1 é»˜è®¤ä½¿ç”¨ keep-alive æ¥å»ºç«‹æŒä¹…è¿æ¥ï¼Œé‚£ä¹ˆåœ¨å®¢æˆ·ç«¯å±‚é¢ï¼Œæ€ä¹ˆç»´æŠ¤å¤šä¸ªè¿æ¥ï¼Œå¹¶åœ¨ä½¿ç”¨æ—¶æ€ä¹ˆæŸ¥æ‰¾è¿æ¥å°±æˆäº†æœ¬ç‰‡åˆ†æçš„é‡ç‚¹ã€‚</p><p><strong>PSï¼šæœ¬æ–‡æºç çš„ç‰ˆæœ¬ä¸º 3.14.0</strong></p><h5 id="ConnectInterceptor-intercept"><a href="#ConnectInterceptor-intercept" class="headerlink" title="ConnectInterceptor::intercept"></a>ConnectInterceptor::intercept</h5><p>ä»å®˜æ–¹æ³¨é‡Šå¯ä»¥çœ‹å‡ºï¼ŒconnectInterceptor çš„ä½œç”¨æ˜¯ï¼š<strong>å¼€å¯ä¸€ä¸ªåˆ°ç›®æ ‡æœåŠ¡å™¨çš„è¿æ¥ï¼Œå¹¶å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨</strong>ã€‚æ‰€ä»¥æ— è®ºæ˜¯ç»å† TCP å’Œ TLS æ¡æ‰‹æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œè¿˜æ˜¯ä»è¿æ¥æ± ä¸­æŸ¥è¯¢ä¸€ä¸ªè¿æ¥ï¼Œéƒ½æ˜¯åœ¨è¿™ä¸€æ­¥å®Œæˆï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›å…¥ <code>transmitter.newExchange()</code> è¿™ä¸ªæ–¹æ³•ä¸­ä¸€æ¢ç©¶ç«Ÿã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** Opens a connection to the target server and proceeds to the next interceptor. */</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ConnectInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">OkHttpClient</span> client<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">ConnectInterceptor</span><span class="token punctuation">(</span><span class="token class-name">OkHttpClient</span> client<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> client<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token class-name">Response</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Chain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">RealInterceptorChain</span> realChain <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">RealInterceptorChain</span><span class="token punctuation">)</span> chain<span class="token punctuation">;</span>        <span class="token class-name">Request</span> request <span class="token operator">=</span> realChain<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Transmitter</span> transmitter <span class="token operator">=</span> realChain<span class="token punctuation">.</span><span class="token function">transmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// We need the network to satisfy this request. Possibly for validating a conditional GET.</span>        <span class="token keyword">boolean</span> doExtensiveHealthChecks <span class="token operator">=</span> <span class="token operator">!</span>request<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Exchange</span> exchange <span class="token operator">=</span> transmitter<span class="token punctuation">.</span><span class="token function">newExchange</span><span class="token punctuation">(</span>chain<span class="token punctuation">,</span> doExtensiveHealthChecks<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> realChain<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> transmitter<span class="token punctuation">,</span> exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>transmitter.newExchange(chain, doExtensiveHealthChecks)</code> çš„è¿”å›å€¼æ˜¯ Exchange å¯¹è±¡ï¼Œé‚£æˆ‘ä»¬å…ˆçœ‹çœ‹ Exchangeã€ExchangeFinderã€ExchangeCodec è¿™å‡ ä¸ªç±»çš„ä¸»è¦åŠŸèƒ½å§ã€‚</p><ul><li>Exchangeï¼šTransmits a single HTTP request and a response pair.</li><li>ExchangeFinderï¼šAttempts to find the connections for a sequence of exchanges.</li><li>ExchangeCodecï¼šEncodes HTTP requests and decodes HTTP responses.</li></ul><p>å¯è§ï¼ŒExchange ç”¨äºä¼ è¾“å•ä¸ª request å’Œ response å¯¹ï¼Œä¹Ÿå°±æ˜¯å•æ¬¡çš„ http è¯·æ±‚ï¼ŒExchange å†…éƒ¨åŒ…å« ExchangeCodecï¼Œè´Ÿè´£å¤„ç†å®é™…çš„ I&#x2F;O æ“ä½œï¼Œè€Œ ExchangeFinder åˆ™è´Ÿè´£æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ connection æ¥æ‰¿è½½ Exchange å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ‰¿è½½å•æ¬¡çš„ http è¯·æ±‚ã€‚</p><p>PSï¼šå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ª Exchange å¯¹åº”å•æ¬¡çš„ http è¯·æ±‚ï¼Œç”¨æˆ·åœ¨å‘é€ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ª callï¼Œå¹¶ä¸ä¸€å®šåªå¯¹åº”ä¸€ä¸ª Exchangeï¼Œå¯èƒ½ç”±äºé‡å®šå‘ï¼Œæˆ–è€…å…ˆè¿›è¡Œä»£ç†æœåŠ¡è®¤è¯ï¼Œå‘é€äº†å¤šä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ª Exchangeï¼Œä½†å¯¹äºç”¨æˆ·æ¥è¯´ä¸€ä¸ªè¯·æ±‚ä¹Ÿå°±æ˜¯ä¸€ä¸ª callï¼Œå¹¶ä¸éœ€è¦æ„ŸçŸ¥ Exchange çš„å­˜åœ¨ã€‚</p><h5 id="Transmitter-newExchange"><a href="#Transmitter-newExchange" class="headerlink" title="Transmitter::newExchange"></a>Transmitter::newExchange</h5><p>transmitter åœ¨æ³¨é‡Šä¸­ä¸º Bridge between OkHttpâ€™s application and network layers. å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªç±»çš„ä½œç”¨æ˜¯å¸®åŠ© okhttpClient ä¸ connectionPoolã€requestã€responseã€streams å»ºç«‹è”ç³»ï¼Œä»¥ä¾¿è®¿é—®åˆ° okhttpClient çš„é…ç½®ä¿¡æ¯ã€‚</p><p>åœ¨å¦‚ä¸‹æ–¹æ³•ä¸­ï¼Œé€šè¿‡ <code>exchangeFinder.find()</code> æ–¹æ³•å¼€å§‹å¯»æ‰¾å¯ç”¨çš„è¿æ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»§ç»­å‘ä¸‹çœ‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** Returns a new exchange to carry a new request and response. */</span><span class="token class-name">Exchange</span> <span class="token function">newExchange</span><span class="token punctuation">(</span><span class="token class-name">Interceptor<span class="token punctuation">.</span>Chain</span> chain<span class="token punctuation">,</span> <span class="token keyword">boolean</span> doExtensiveHealthChecks<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>noMoreExchanges<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"released"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>exchange <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"exchange != null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">ExchangeCodec</span> codec <span class="token operator">=</span> exchangeFinder<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> chain<span class="token punctuation">,</span> doExtensiveHealthChecks<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Exchange</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Exchange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> call<span class="token punctuation">,</span> eventListener<span class="token punctuation">,</span> exchangeFinder<span class="token punctuation">,</span> codec<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>exchange <span class="token operator">=</span> result<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>exchangeRequestDone <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>exchangeResponseDone <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ExchangeFinder-find"><a href="#ExchangeFinder-find" class="headerlink" title="ExchangeFinder::find"></a>ExchangeFinder::find</h5><p>é¦–å…ˆè·å–äº†ä¸€ç³»åˆ—è¶…æ—¶æ—¶é—´ï¼Œç„¶ååˆä¼ å…¥äº† <code>findHealthyConnection()</code> ä¸­ï¼Œå†é€šè¿‡æ‰¾åˆ°çš„ connection æ–°å»ºäº† ExchangeCodec å¯¹è±¡ï¼Œä¸Šé¢å·²ç»æè¿‡ï¼ŒExchangeCodec å¯¹è±¡è´Ÿè´£å¤„ç† I&#x2F;O æ“ä½œï¼Œæœ‰äº†è¿™ä¸ªå¯¹è±¡å°±å¯ä»¥ä¸ä»æœåŠ¡ç«¯å†™å…¥è¯»å‡ºæ•°æ®äº†ï¼Œé‚£æˆ‘ä»¬è·Ÿä¸ŠèŠ‚å¥ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ExchangeCodec</span> <span class="token function">find</span><span class="token punctuation">(</span>    <span class="token class-name">OkHttpClient</span> client<span class="token punctuation">,</span> <span class="token class-name">Interceptor<span class="token punctuation">.</span>Chain</span> chain<span class="token punctuation">,</span> <span class="token keyword">boolean</span> doExtensiveHealthChecks<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> connectTimeout <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">connectTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> readTimeout <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">readTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> writeTimeout <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">writeTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> pingIntervalMillis <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">pingIntervalMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> connectionRetryEnabled <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">retryOnConnectionFailure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">RealConnection</span> resultConnection <span class="token operator">=</span> <span class="token function">findHealthyConnection</span><span class="token punctuation">(</span>connectTimeout<span class="token punctuation">,</span> readTimeout<span class="token punctuation">,</span>            writeTimeout<span class="token punctuation">,</span> pingIntervalMillis<span class="token punctuation">,</span> connectionRetryEnabled<span class="token punctuation">,</span> doExtensiveHealthChecks<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> resultConnection<span class="token punctuation">.</span><span class="token function">newCodec</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> chain<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RouteException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">trackFailure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> e<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">trackFailure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RouteException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ExchangeFinder-findHealthyConnection"><a href="#ExchangeFinder-findHealthyConnection" class="headerlink" title="ExchangeFinder::findHealthyConnection"></a>ExchangeFinder::findHealthyConnection</h5><p>è¯¥æ–¹æ³•å†…éƒ¨æœ‰ä¸€ä¸ª <code>while(true)</code> å¾ªç¯ï¼Œåœ¨å¾ªç¯å†…éƒ¨ä¼šä¸æ–­åœ°å»è·å–ä¸€ä¸ªå¯ç”¨çš„è¿æ¥ï¼Œå¹¶æ£€æŸ¥è¯¥è¿æ¥æ˜¯å¦å¥åº·ï¼Œå¦‚æœå¥åº·ï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªå¯ç”¨ä¸”å¥åº·çš„è¿æ¥ï¼Œç›´è‡³æ‰¾åˆ°ä¸ºæ­¢ï¼Œè€Œå®é™…è·å– connection çš„è¿‡ç¨‹å°±åœ¨ <code>findConnection()</code> ä¸­ï¼Œç»§ç»­ï¼</p><p>PSï¼šæ³¨æ„ï¼Œè¿™é‡Œè¯´çš„<strong>å¯ç”¨å’Œå¥åº·</strong>æ˜¯ä¸¤ä¸ªä¸åŒçš„æŒ‡æ ‡ï¼›</p><ul><li>å¯ç”¨ï¼šæŒ‡è¯¥è¿æ¥å·²ç»å»ºç«‹ï¼Œå¯ä»¥ä¸æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡ï¼›</li><li>å¥åº·ï¼šæŒ‡è¯¥è¿æ¥æ˜¯å¦å‡†å¤‡å¥½æ‰¿è½½ä¸€ä¸ªæ–°çš„è¾“å…¥è¾“å‡ºæµï¼›</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Finds a connection and returns it if it is healthy. If it is unhealthy the process is repeated * until a healthy connection is found. */</span><span class="token keyword">private</span> <span class="token class-name">RealConnection</span> <span class="token function">findHealthyConnection</span><span class="token punctuation">(</span><span class="token keyword">int</span> connectTimeout<span class="token punctuation">,</span> <span class="token keyword">int</span> readTimeout<span class="token punctuation">,</span>                                             <span class="token keyword">int</span> writeTimeout<span class="token punctuation">,</span> <span class="token keyword">int</span> pingIntervalMillis<span class="token punctuation">,</span> <span class="token keyword">boolean</span> connectionRetryEnabled<span class="token punctuation">,</span>                                             <span class="token keyword">boolean</span> doExtensiveHealthChecks<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">RealConnection</span> candidate <span class="token operator">=</span> <span class="token function">findConnection</span><span class="token punctuation">(</span>connectTimeout<span class="token punctuation">,</span> readTimeout<span class="token punctuation">,</span> writeTimeout<span class="token punctuation">,</span>                                                  pingIntervalMillis<span class="token punctuation">,</span> connectionRetryEnabled<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// If this is a brand new connection, we can skip the extensive health checks.</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>candidate<span class="token punctuation">.</span>successCount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> candidate<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// Do a (potentially slow) check to confirm that the pooled connection is still good. If it</span>        <span class="token comment">// isn't, take it out of the pool and start again.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>candidate<span class="token punctuation">.</span><span class="token function">isHealthy</span><span class="token punctuation">(</span>doExtensiveHealthChecks<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            candidate<span class="token punctuation">.</span><span class="token function">noNewExchanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> candidate<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ExchangeFinder-findConnection"><a href="#ExchangeFinder-findConnection" class="headerlink" title="ExchangeFinder::findConnection"></a>ExchangeFinder::findConnection</h5><p>ç»ˆäºè§¦åŠåˆ°é—®é¢˜çš„æœ¬è´¨äº†ï¼Œè¯¥æ®µä»£ç è¾ƒé•¿ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹äº”ä¸ªè¿‡ç¨‹ã€‚ğŸ­</p><ol><li>é‡ç”¨å½“å‰ transmitter ä¸­çš„ connectionï¼Œåˆ¤æ–­æ˜¯å¦å¯ç”¨ï¼›</li><li>ç¬¬ä¸€æ¬¡å°è¯•ä» connectionPool ä¸­è·å– connectionï¼›</li><li>æ‹¿åˆ°ä¸€ç³»åˆ— IP addresses åç¬¬äºŒæ¬¡å°è¯•ä» connectionPool ä¸­è·å– connectionï¼›</li><li>æ–°åˆ›å»ºä¸€ä¸ª connectionï¼Œå¹¶è¿›è¡Œ TCP å’Œ TLS æ¡æ‰‹ï¼›</li><li>æœ€åä¸€æ¬¡å°è¯•ä» connectionPool ä¸­è·å– connectionï¼›</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Returns a connection to host a new stream. This prefers the existing connection if it exists, * then the pool, finally building a new connection. */</span><span class="token keyword">private</span> <span class="token class-name">RealConnection</span> <span class="token function">findConnection</span><span class="token punctuation">(</span><span class="token keyword">int</span> connectTimeout<span class="token punctuation">,</span> <span class="token keyword">int</span> readTimeout<span class="token punctuation">,</span> <span class="token keyword">int</span> writeTimeout<span class="token punctuation">,</span>                                      <span class="token keyword">int</span> pingIntervalMillis<span class="token punctuation">,</span> <span class="token keyword">boolean</span> connectionRetryEnabled<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">boolean</span> foundPooledConnection <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token class-name">RealConnection</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token class-name">Route</span> selectedRoute <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token class-name">RealConnection</span> releasedConnection<span class="token punctuation">;</span>    <span class="token class-name">Socket</span> toClose<span class="token punctuation">;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>transmitter<span class="token punctuation">.</span><span class="token function">isCanceled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token string">"Canceled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        hasStreamFailure <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// This is a fresh attempt.</span>        <span class="token class-name">Route</span> previousRoute <span class="token operator">=</span> <span class="token function">retryCurrentRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">?</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">// Attempt to use an already-allocated connection. We need to be careful here because our</span>        <span class="token comment">// already-allocated connection may have been restricted from creating new exchanges.</span>        releasedConnection <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>        toClose <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>noNewExchanges            <span class="token operator">?</span> transmitter<span class="token punctuation">.</span><span class="token function">releaseConnectionNoEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>transmitter<span class="token punctuation">.</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// We had an already-allocated connection and it's good.</span>            result <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>            releasedConnection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// Attempt to get a connection from the pool.</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">.</span><span class="token function">transmitterAcquirePooledConnection</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> transmitter<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                foundPooledConnection <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                result <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                selectedRoute <span class="token operator">=</span> previousRoute<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">closeQuietly</span><span class="token punctuation">(</span>toClose<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>releasedConnection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        eventListener<span class="token punctuation">.</span><span class="token function">connectionReleased</span><span class="token punctuation">(</span>call<span class="token punctuation">,</span> releasedConnection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>foundPooledConnection<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        eventListener<span class="token punctuation">.</span><span class="token function">connectionAcquired</span><span class="token punctuation">(</span>call<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// If we found an already-allocated or pooled connection, we're done.</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// If we need a route selection, make one. This is a blocking operation.</span>    <span class="token keyword">boolean</span> newRouteSelection <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedRoute <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>routeSelection <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>routeSelection<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        newRouteSelection <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        routeSelection <span class="token operator">=</span> routeSelector<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span><span class="token punctuation">></span></span> routes <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>transmitter<span class="token punctuation">.</span><span class="token function">isCanceled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token string">"Canceled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>newRouteSelection<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// Now that we have a set of IP addresses, make another attempt at getting a connection from</span>            <span class="token comment">// the pool. This could match due to connection coalescing.</span>            routes <span class="token operator">=</span> routeSelection<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">.</span><span class="token function">transmitterAcquirePooledConnection</span><span class="token punctuation">(</span>                address<span class="token punctuation">,</span> transmitter<span class="token punctuation">,</span> routes<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                foundPooledConnection <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                result <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>foundPooledConnection<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedRoute <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                selectedRoute <span class="token operator">=</span> routeSelection<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// Create a connection and assign it to this allocation immediately. This makes it possible</span>            <span class="token comment">// for an asynchronous cancel() to interrupt the handshake we're about to do.</span>            result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RealConnection</span><span class="token punctuation">(</span>connectionPool<span class="token punctuation">,</span> selectedRoute<span class="token punctuation">)</span><span class="token punctuation">;</span>            connectingConnection <span class="token operator">=</span> result<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// If we found a pooled connection on the 2nd time around, we're done.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>foundPooledConnection<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        eventListener<span class="token punctuation">.</span><span class="token function">connectionAcquired</span><span class="token punctuation">(</span>call<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Do TCP + TLS handshakes. This is a blocking operation.</span>    result<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>connectTimeout<span class="token punctuation">,</span> readTimeout<span class="token punctuation">,</span> writeTimeout<span class="token punctuation">,</span> pingIntervalMillis<span class="token punctuation">,</span>                   connectionRetryEnabled<span class="token punctuation">,</span> call<span class="token punctuation">,</span> eventListener<span class="token punctuation">)</span><span class="token punctuation">;</span>    connectionPool<span class="token punctuation">.</span>routeDatabase<span class="token punctuation">.</span><span class="token function">connected</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        connectingConnection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">// Last attempt at connection coalescing, which only occurs if we attempted multiple</span>        <span class="token comment">// concurrent connections to the same host.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connectionPool<span class="token punctuation">.</span><span class="token function">transmitterAcquirePooledConnection</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> transmitter<span class="token punctuation">,</span> routes<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// We lost the race! Close the connection we created and return the pooled connection.</span>            result<span class="token punctuation">.</span>noNewExchanges <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            socket <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            result <span class="token operator">=</span> transmitter<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            connectionPool<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>            transmitter<span class="token punctuation">.</span><span class="token function">acquireConnectionNoEvents</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">closeQuietly</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span>    eventListener<span class="token punctuation">.</span><span class="token function">connectionAcquired</span><span class="token punctuation">(</span>call<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹ä»¥ä¸Šäº”ä¸ªè¿‡ç¨‹ï¼Œè§£é‡Šä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š</p><p><strong>1.ä¸ºä»€ä¹ˆ transmitter ä¸­ä¼šå·²ç»å­˜åœ¨ä¸€ä¸ª connection å‘¢ï¼Ÿ</strong></p><p>transmitter åœ¨ç”¨æˆ·åˆ›å»º call æ—¶å°±ä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œå†…éƒ¨æŒæœ‰ä¸€ä¸ª connectionï¼Œå¹¶ä¸” transmitter ä¸€ç›´åœ¨ interceptor ä¸­ä¼ é€’ï¼Œåœ¨ç¬¬ä¸€ä¸ª interceptor ä¹Ÿå°±æ˜¯ RetryAndFollowUpInterceptor ä¸­å‘ç”Ÿè¯·æ±‚å¤±è´¥æˆ–è€…é‡å®šå‘æ—¶ï¼Œé‚£ä¹ˆä¹‹å‰å·²ç»åˆ›å»ºå¥½çš„ connection ä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼Œæ¥ä¸‹æ¥éœ€è¦åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ª connection èƒ½å¦å†åˆ›å»ºæ–°çš„ exchangeï¼Œä¹Ÿå°±æ˜¯èƒ½å¦å†å‘é€ request æ¥æ”¶ responseï¼Œå¦‚æœæ²¡æ³•å¤ç”¨ï¼Œé‚£ä¹ˆä¼šé‡Šæ”¾è¯¥ connectionã€‚</p><p><strong>2.ä¸‰æ¬¡ä» connectionPool ä¸­è·å– connection çš„åŒºåˆ«ï¼Ÿ</strong></p><p>å…¶ä¸­ä¸‰æ¬¡è°ƒç”¨ <code>transmitterAcquirePooledConnection()</code> çš„åŒºåˆ«ä½“ç°åœ¨åä¸¤ä¸ªå‚æ•°ä¸Šï¼š</p><ul><li><code>List&lt;Route&gt; routes</code>ï¼šå®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è·¯ç”±åˆ—è¡¨</li><li><code>boolean requireMultiplexed</code>ï¼šæ˜¯å¦å…·æœ‰å¤šè·¯å¤ç”¨ç‰¹æ€§</li></ul><p>è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯ä¸º HTTP&#x2F;2.0 æœåŠ¡çš„ï¼Œå¸¸ç”¨çš„ HTTP&#x2F;1.1 ä¸ä¼šåœ¨åä¸¤æ¬¡è°ƒç”¨ä¸­è·å–åˆ° connectionã€‚</p><ol><li>ç¬¬ä¸€æ¬¡ <code>List&lt;Route&gt; routes</code> ä¸º nullï¼Œ<code>boolean requireMultiplexed</code> ä¸º falseï¼Œç”±äºæ­¤æ—¶æ²¡æœ‰è·¯ç”±ä¿¡æ¯ï¼Œå½“ addressã€host åŒ¹é…ä¸€è‡´æ—¶ï¼Œå³è®¤ä¸ºæ˜¯å¯ç”¨çš„ connectionï¼›</li><li>ç¬¬äºŒæ¬¡ <code>List&lt;Route&gt; routes</code> ä¸º routesï¼Œ<code>boolean requireMultiplexed</code> ä¸º falseï¼Œåœ¨ address ä¸€è‡´ä½† host ä¸ä¸€è‡´æ—¶ï¼Œå†ä¾æ® routes è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥ proxy ä¸ inetSocketAddress ä¸€è‡´æ—¶ï¼Œåˆ™è®¤ä¸ºæ˜¯å¯ç”¨çš„ connectionï¼Œè¿™æ˜¯é’ˆå¯¹ HTTP&#x2F;2.0 çš„æ“ä½œï¼›</li><li>ç¬¬ä¸‰æ¬¡ <code>List&lt;Route&gt; routes</code> ä¸º routesï¼Œ<code>boolean requireMultiplexed</code> ä¸º trueï¼Œä¼šå…ˆåˆ¤æ–­å½“å‰ connection æ˜¯å¦ä¸º HTTP&#x2F;2.0 åè®®ï¼Œè‹¥æ˜¯ï¼Œåç»­åˆ¤æ–­è¿‡ç¨‹ä¸ç¬¬äºŒæ¬¡ä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯é’ˆå¯¹ HTTP&#x2F;2.0 çš„æ“ä½œï¼›</li></ol><p><strong>3.ä¸ºä»€ä¹ˆå·²ç»æ–°å»º connection äº†ï¼Œä»ç„¶è¦å°è¯•ç¬¬ä¸‰æ¬¡ä» connectionPool ä¸­è·å– connectionï¼Ÿ</strong></p><p>è¿™æ˜¯å› ä¸ºæ–°å»ºç«‹çš„ connection çš„æ¡æ‰‹è¿‡ç¨‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨æ¡æ‰‹è¿›è¡Œçš„åŒæ—¶ï¼ŒconnectionPool ä¸­å¯èƒ½å·²ç»æ–°å­˜å…¥äº†ç›¸åŒçš„ connectionï¼Œå¦‚æœæ­¤æ—¶åŒ¹é…æˆåŠŸï¼Œåˆ™ä¼šä½¿ç”¨å·²æœ‰çš„ connectionï¼Œé‡Šæ”¾æ‰æ–°å»ºçš„ connectionï¼Œè‹¥åŒ¹é…å¤±è´¥ï¼Œåˆ™ä¼šæŠŠæ–°å»ºçš„ connection å­˜å…¥ connectionPool ä¸­ã€‚</p><p>PSï¼šæœ¨æœ‰æœ¨è§‰å¾—è·å– connection çš„è¿‡ç¨‹å¯ä»¥ç”¨ä¸€å¥è¯—æ¥å½¢å®¹ï¼Œæ›¾ç»æ²§æµ·éš¾ä¸ºæ°´ï¼Œé™¤å´å·«å±±ä¸æ˜¯äº‘ï¼Œä¸€å¿ƒåªæƒ³æ‰¾å›æ›¾ç»çš„ connectionï¼Œä¸æƒœä¸‰é¡¾èŒ…åºï¼Œç”šè‡³ç¬¬ä¸‰æ¬¡å‰å·²ç»ä¸ä»–äººè®¸ä¸‹æµ·èª“å±±ç›Ÿï¼Œä¸€å‘ç°å‰ä»»çš„è¸ªè¿¹ä¸æƒœæŠ›å¼ƒçœ¼å‰ä½³äººå¯»ä»–è€Œå»ï¼Œè€Œè¿™å°±æ˜¯ okhttp ç§°ä¸ºé«˜æ€§èƒ½çš„ç§˜è¯€ã€‚</p><p>ä¸Šé¢å·²ç»è®²äº†ä» connectionPool è·å– connection çš„è¿‡ç¨‹ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯çœ‹ä¸€ä¸‹æºç å­ã€‚</p><h5 id="RealConnectionPool-transmitterAcquirePooledConnection"><a href="#RealConnectionPool-transmitterAcquirePooledConnection" class="headerlink" title="RealConnectionPool::transmitterAcquirePooledConnection"></a>RealConnectionPool::transmitterAcquirePooledConnection</h5><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢ä¼ å…¥çš„ requireMultiplexed åœ¨æ­¤å¤„çš„ä½¿ç”¨ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ ¸å¿ƒä»£ç  <code>connection.isEligible(address, routes)</code>ï¼Œç”¨äºåˆ¤æ–­ connection æ˜¯å¦åˆæ³•ï¼Œç»§ç»­å‘ä¸‹çœ‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Attempts to acquire a recycled connection to &#123;@code address&#125; for &#123;@code transmitter&#125;. Returns * true if a connection was acquired. */</span><span class="token keyword">boolean</span> <span class="token function">transmitterAcquirePooledConnection</span><span class="token punctuation">(</span><span class="token class-name">Address</span> address<span class="token punctuation">,</span> <span class="token class-name">Transmitter</span> transmitter<span class="token punctuation">,</span>                                           <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span><span class="token punctuation">></span></span> routes<span class="token punctuation">,</span> <span class="token keyword">boolean</span> requireMultiplexed<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">holdsLock</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">RealConnection</span> connection <span class="token operator">:</span> connections<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>requireMultiplexed <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>connection<span class="token punctuation">.</span><span class="token function">isMultiplexed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>connection<span class="token punctuation">.</span><span class="token function">isEligible</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> routes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        transmitter<span class="token punctuation">.</span><span class="token function">acquireConnectionNoEvents</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="RealConnection-isEligible"><a href="#RealConnection-isEligible" class="headerlink" title="RealConnection::isEligible"></a>RealConnection::isEligible</h5><p>åœ¨è¿™ä¸ªå‡½æ•°ä¸­å°±å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°æ€ä¹ˆåˆ¤æ–­ä¸€ä¸ª connection æ˜¯å¦åˆæ³•åœ°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äº HTTP&#x2F;1.1 çš„ connection åªåˆ¤æ–­ address å’Œ host ä¹‹åå°±å¯å¾—å‡ºç»“è®ºï¼Œå¯¹äº HTTP&#x2F;2.0 çš„ connection æ˜æ˜¾æ”¾å®½äº†é¢å¤–çš„å¤ç”¨æ¡ä»¶ï¼Œè¿™è¯´æ˜åœ¨ä¸€å®šç¨‹åº¦ä¸Š HTTP&#x2F;2.0 çš„å¤ç”¨ç‡æ˜¯å¤§äº HTTP&#x2F;1.1 çš„ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Returns true if this connection can carry a stream allocation to &#123;@code address&#125;. If non-null * &#123;@code route&#125; is the resolved route for a connection. */</span><span class="token keyword">boolean</span> <span class="token function">isEligible</span><span class="token punctuation">(</span><span class="token class-name">Address</span> address<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span><span class="token punctuation">></span></span> routes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// If this connection is not accepting new exchanges, we're done.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>transmitters<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> allocationLimit <span class="token operator">||</span> noNewExchanges<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// If the non-host fields of the address don't overlap, we're done.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Internal</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">equalsNonHost</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// If the host exactly matches, we're done: this connection can carry the address.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// This connection is a perfect match.</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// At this point we don't have a hostname match. But we still be able to carry the request if</span>    <span class="token comment">// our connection coalescing requirements are met.</span>    <span class="token comment">// 1. This connection must be HTTP/2.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>http2Connection <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// 2. The routes must share an IP address.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>routes <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">routeMatchesAny</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// 3. This connection's server certificate's must cover the new host.</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">hostnameVerifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">OkHostnameVerifier</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">supportsUrl</span><span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// 4. Certificate pinning must match the host.</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        address<span class="token punctuation">.</span><span class="token function">certificatePinner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">handshake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">peerCertificates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SSLPeerUnverifiedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// The caller's address can be carried by this connection.</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="å®Œç»“æœªåŠ"><a href="#å®Œç»“æœªåŠ" class="headerlink" title="å®Œç»“æœªåŠ"></a>å®Œç»“æœªåŠ</h5><p>å°±åœ¨ä»¥ä¸ºåˆ†æåˆ°æ­¤ç»“æŸæ—¶ï¼Œæœ¬ç€å¥½ç©çš„å¿ƒæ€æƒ³çœ‹ç€å¤ç”¨æµç¨‹å®Œæ•´èµ°ä¸€éï¼Œäºæ˜¯ä¾¿æœ‰äº†ä»¥ä¸‹çš„ç‹—è¡€å†ç¨‹ï¼š</p><p>ä»¥ä¸‹ debug ä»£ç åŸºäº okhttp:3.12.0ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„ AVD æ˜¯ Android 4.4 ç‰ˆæœ¬ä»¥ä¸‹çš„ï¼Œåªèƒ½ç”¨ okhttp:3.14.0 åŠä»¥ä¸‹ç‰ˆæœ¬ï¼Œä¸è¿‡ä¸»ä½“ä»£ç é€»è¾‘æ²¡ä»€ä¹ˆå˜åŠ¨ï¼Œä¸å½±å“æµ‹è¯• &#x2F;(ã„’oã„’)&#x2F;</p><p>å¥½ï¼Œæˆ‘ä»¬å…ˆéšä¾¿å†™ä¸€ä¸ªç½‘ç»œè¯·æ±‚è¯•è¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">OkHttpClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OkHttpClient<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_get<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Request</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Call</span> call <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">newCall</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>            call<span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token annotation punctuation">@Override</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token class-name">Call</span> call<span class="token punctuation">,</span> <span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token punctuation">&#125;</span>                <span class="token annotation punctuation">@Override</span>                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onResponse</span><span class="token punctuation">(</span><span class="token class-name">Call</span> call<span class="token punctuation">,</span> <span class="token class-name">Response</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å°†æ–­ç‚¹æ‰“åœ¨ç¬¬ä¸€æ¬¡ä» connectionPool ä¸­è·å– connection çš„ä½ç½®ï¼ˆç”±äºæ˜¯ HTTP&#x2F;1.1 åè®®ï¼Œæ‰€ä»¥ç¬¬äºŒä¸‰æ¬¡è·å– connection çš„è¿‡ç¨‹æ˜¯ä¸ç”¨çœ‹çš„ï¼‰ï¼š</p><p>æ­¤æ—¶ connectionPool ä¸­å·²ç»æœ‰ 7 ä¸ªç›¸åŒçš„ connection äº†ï¼Œä¸‹ä¸ªæ–­ç‚¹å¯ä»¥æ‰“åœ¨åˆ¤æ–­æ˜¯å¦åˆæ³•çš„ä½ç½®ï¼š</p><p>å¯è§ï¼ŒHTTP åè®®ä¸º HTTP&#x2F;1.1ï¼Œæ­¤æ—¶æˆ‘ä»¬å·²ç»å‘é€äº†å¾ˆå¤šä¸ªåŒæ ·çš„è¯·æ±‚ï¼Œå¯æ˜¯åœ¨ <code>isEligible()</code> åˆ¤æ–­çš„ç¬¬ä¸€æ­¥å°±è¿”å› false äº†ï¼ŒåŸå› å‡ºåœ¨ <code>allocations.size() &gt;= allocationLimit</code> ä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ä¸ªå˜é‡æ˜¯ä»€ä¹ˆä½œç”¨ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * The maximum number of concurrent streams that can be carried by this connection. If &#123;@code * allocations.size() &lt; allocationLimit&#125; then new streams can be created on this connection. */</span><span class="token keyword">public</span> <span class="token keyword">int</span> allocationLimit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">/** Current streams carried by this connection. */</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Reference</span><span class="token punctuation">&lt;</span><span class="token class-name">StreamAllocation</span><span class="token punctuation">></span><span class="token punctuation">></span></span> allocations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æ³¨é‡Šå¯çŸ¥ï¼Œåœ¨ HTTP&#x2F;1.1 åè®®ä¸‹ï¼Œå½“å‰ connection å¿…é¡»å¤„ç†å®Œå½“å‰ streamï¼Œæ‰å¯ä»¥å†ç»§ç»­å¤„ç†å…¶ä»– streamï¼Œæ‰€ä»¥ allocationLimit çš„å€¼å§‹ç»ˆä¸º 1ï¼Œä¹Ÿå°±æ˜¯è¯´ HTTP&#x2F;1.1 æ˜¯ä¸æ”¯æŒå¤šè·¯å¤ç”¨çš„ï¼Œè€Œ HTTP&#x2F;2.0 åè®®åˆ™å¯ä»¥ä¿®æ”¹ allocationLimit çš„å€¼ã€‚</p><p><strong>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¯·æ±‚æˆåŠŸåè¿”å› response ä»¥åï¼ŒæŒ‰ç†è¯´åº”è¯¥é‡Šæ”¾ streamï¼Œå°† connection ç½®ä¸ºç©ºé—²çŠ¶æ€ï¼Œä½†æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆè¿˜æŒæœ‰ stream å‘¢ï¼Ÿ</strong></p><p>ä¸ºäº†ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ okhttp æ˜¯åœ¨ CallServerInterceptor ä¸­è¿›è¡Œè¯»å†™æ“ä½œï¼Œæ‰€ä»¥åœ¨è¯»å–å®Œæ•°æ®ä»¥åï¼Œå…³é—­ stream çš„æ“ä½œä¹Ÿåº”è¯¥åœ¨è¿™é‡Œè¿›è¡Œï¼Œåœ¨ç»å†ä¸€äº› debug åï¼Œæˆ‘ä»¬ç¡®å®šäº†é—®é¢˜å‘ç”Ÿåœ¨è¿™ä¸ªåœ°æ–¹ï¼š</p><p>å¯ä»¥å‘ç°ï¼Œåœ¨è¯»å– responseBody æ—¶å¦‚æœ Transfer-Encoding ä¸º chunked æ—¶ï¼Œåˆ™ä¼š</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç è§£æ </tag>
            
            <tag> okhttp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 371 åœºå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/11/12/weekly-contest-371/"/>
      <url>/2023/11/12/weekly-contest-371/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>è¿™åœºå€’åœ¨ T3 äº†ï¼Œä¸€é“æ€ç»´é¢˜ï¼Œèµ›æ—¶è„‘å­ç¡¬æ˜¯æ²¡è½¬è¿‡æ¥ï¼Œå¯¼è‡´ä¸€ç›´æ²¡å»çœ‹ T4ï¼ŒT4 ä¹Ÿæ˜¯ä¸€é“ç»å…¸å¸¦æœ‰åˆ é™¤æ•°æ®çš„å­—å…¸æ ‘çš„é¢˜ï¼Œåº”è¯¥æ˜¯èƒ½æ‹¿ä¸‹çš„ï¼Œæ€»ä¹‹è¿™åœºéå¸¸å¯æƒœï¼Œå¯ä»¥ AK çš„ï¼Œæœ€åå´æ‰äº†å¤§åˆ†ã€‚</p><p>PSï¼šå°å£°æ¯”æ¯”ï¼Œéƒ½æ˜¯æ¥¼ä¸‹è£…ä¿® duangduangduangduang çš„é”…ã€‚</p><p><img src="https://s2.loli.net/2023/11/12/grFhYXe2cAbkSKi.png" alt="weekly_contest_371_rating.png"></p><h5 id="T1-æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼-I"><a href="#T1-æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼-I" class="headerlink" title="T1. æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼ I"></a><a href="https://leetcode.cn/contest/weekly-contest-371/problems/maximum-strong-pair-xor-i/">T1. æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼ I</a></h5><p>åŒ T4</p><h5 id="T2-é«˜è®¿é—®å‘˜å·¥"><a href="#T2-é«˜è®¿é—®å‘˜å·¥" class="headerlink" title="T2. é«˜è®¿é—®å‘˜å·¥"></a><a href="https://leetcode.cn/contest/weekly-contest-371/problems/high-access-employees/">T2. é«˜è®¿é—®å‘˜å·¥</a></h5><p>ç›´æ¥æ¨¡æ‹Ÿå°±è¡Œï¼Œæ³¨æ„æ“ä½œæ•°æ®</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">findHighAccessEmployees</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span><span class="token punctuation">></span></span> access_times<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> access_times<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>access_times<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>access_times<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>access_times<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> entry <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> key <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> value <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> value<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> value<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="3-æœ€å¤§åŒ–æ•°ç»„æœ«ä½å…ƒç´ çš„æœ€å°‘æ“ä½œæ¬¡æ•°"><a href="#3-æœ€å¤§åŒ–æ•°ç»„æœ«ä½å…ƒç´ çš„æœ€å°‘æ“ä½œæ¬¡æ•°" class="headerlink" title="3. æœ€å¤§åŒ–æ•°ç»„æœ«ä½å…ƒç´ çš„æœ€å°‘æ“ä½œæ¬¡æ•°"></a><a href="https://leetcode.cn/contest/weekly-contest-371/problems/minimum-operations-to-maximize-last-elements-in-arrays/">3. æœ€å¤§åŒ–æ•°ç»„æœ«ä½å…ƒç´ çš„æœ€å°‘æ“ä½œæ¬¡æ•°</a></h5><p>åªéœ€è¦åˆ†åˆ«æšä¸¾ä¸¤ä¸ªæ•°ç»„çš„æœ€åä¸¤ä¸ªæ•°å°±è¡Œäº†ï¼ŒçœŸä¸çŸ¥é“å½“æ—¶åœ¨æƒ³ä»€ä¹ˆ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minOperations</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>nums1<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums2<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums1<span class="token punctuation">,</span> nums2<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token function">func</span><span class="token punctuation">(</span>nums2<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums1<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums1<span class="token punctuation">,</span> nums2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ans <span class="token operator">>=</span> n <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> last1<span class="token punctuation">,</span> <span class="token keyword">int</span> last2<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums1<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> y <span class="token operator">=</span> nums2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">></span> last1 <span class="token operator">||</span> y <span class="token operator">></span> last2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">></span> last2 <span class="token operator">||</span> y <span class="token operator">></span> last1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                res<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T4-æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼-II"><a href="#T4-æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼-II" class="headerlink" title="T4. æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼ II"></a><a href="https://leetcode.cn/contest/weekly-contest-371/problems/maximum-strong-pair-xor-ii/">T4. æ‰¾å‡ºå¼ºæ•°å¯¹çš„æœ€å¤§å¼‚æˆ–å€¼ II</a></h5><p>è¿™é“é¢˜çš„å…³é”®æ˜¯å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œç„¶åæ‰¾åˆ° <code>2 * x &gt;= y</code> è¿™ä¸ªå…³ç³»å¼å°±ç®—ç ´æ¡ˆäº†ï¼Œå‰©ä¸‹å°±æ˜¯æ¿å­ä»£ç </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">TrieNode</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrieNode</span><span class="token punctuation">[</span><span class="token punctuation">]</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">TrieNode</span> root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximumStrongPairXor</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">insert</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">delete</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token function">getValue</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrieNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>        cur<span class="token punctuation">.</span>cnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> bit <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit<span class="token punctuation">]</span><span class="token punctuation">;</span>            cur<span class="token punctuation">.</span>cnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrieNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>        cur<span class="token punctuation">.</span>cnt<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> bit <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>            cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit<span class="token punctuation">]</span><span class="token punctuation">;</span>            cur<span class="token punctuation">.</span>cnt<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrieNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> bit <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cnt <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res <span class="token operator">=</span> res <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                res <span class="token operator">=</span> res <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>node<span class="token punctuation">[</span>bit<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 117 åœºåŒå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/11/12/biweekly-contest-117/"/>
      <url>/2023/11/12/biweekly-contest-117/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>è¿™åœºå±…ç„¶æ˜¯æ•°å­¦åœºï¼Œå‰ä¸‰é“é¢˜éƒ½æ˜¯é«˜ä¸­æ’åˆ—ç»„åˆçš„çŸ¥è¯†ï¼Œå¥ˆä½•æ—©å·²ç»å¿˜å…‰äº†ï¼Œåœ¨ T3 å¡äº†å¾ˆä¹…çœ‹äº†ä¸€çœ¼ T4ï¼Œå±…ç„¶æ˜¯ä¸€é“ç®€å•ä¼˜å…ˆçº§é˜Ÿåˆ—çš„é¢˜ï¼Œç„¶åæŠŠ T4 ç»™åšäº†ï¼Œå°ä¸Šä¸€ç‚¹åˆ†ï¼ˆä¸è¿‡ä¸‹åœºåˆæ‰å›æ¥äº†å“ˆå“ˆã€‚</p><p><img src="https://s2.loli.net/2023/11/12/HxNuhSgdw2YTOip.png"></p><h5 id="T1-ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ-I"><a href="#T1-ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ-I" class="headerlink" title="T1. ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ I"></a><a href="https://leetcode.cn/contest/biweekly-contest-117/problems/distribute-candies-among-children-i/">T1. ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ I</a></h5><p>åŒ T2</p><h5 id="T2-ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ-II"><a href="#T2-ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ-II" class="headerlink" title="T2. ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ II"></a><a href="https://leetcode.cn/contest/biweekly-contest-117/problems/distribute-candies-among-children-ii/">T2. ç»™å°æœ‹å‹ä»¬åˆ†ç³–æœ II</a></h5><p>å¯ä»¥ç”¨å®¹æ–¥å®šç†åšï¼Œå¯æ˜¯æˆ‘ä¸ä¼šï¼Œè¿˜å¯ä»¥ç®€å•æ¨¡æ‹Ÿï¼Œåªéœ€è¦é™¤å»é¢å¤–è®¡ç®—å°±è¡Œäº†</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">distributeCandies</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> limit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>limit <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> limit<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> limit<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> j <span class="token operator">></span> limit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    j <span class="token operator">=</span> n <span class="token operator">-</span> i <span class="token operator">-</span> limit<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">int</span> diff1 <span class="token operator">=</span> limit <span class="token operator">-</span> j<span class="token punctuation">;</span>                    <span class="token keyword">int</span> diff2 <span class="token operator">=</span> n <span class="token operator">-</span> i <span class="token operator">-</span> j<span class="token punctuation">;</span>                    ans <span class="token operator">+=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>diff1<span class="token punctuation">,</span> diff2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-é‡æ–°æ’åˆ—ååŒ…å«æŒ‡å®šå­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²æ•°ç›®"><a href="#T3-é‡æ–°æ’åˆ—ååŒ…å«æŒ‡å®šå­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²æ•°ç›®" class="headerlink" title="T3. é‡æ–°æ’åˆ—ååŒ…å«æŒ‡å®šå­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²æ•°ç›®"></a><a href="https://leetcode.cn/contest/biweekly-contest-117/problems/number-of-strings-which-can-be-rearranged-to-contain-substring/">T3. é‡æ–°æ’åˆ—ååŒ…å«æŒ‡å®šå­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²æ•°ç›®</a></h5><p>â€œè‡³å°‘å¡«æ»¡å‹â€åˆ†ç»„èƒŒåŒ…ï¼Œæ¯ç»„éƒ½å¯ä»¥ä» <code>a</code> åˆ° <code>z</code> ä¸­é€‰ä¸€ä¸ªï¼Œä½¿ç”¨è®°å¿†åŒ–æ¨¡æ‹Ÿ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">stringCount</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> l <span class="token operator">==</span> t <span class="token operator">&amp;&amp;</span> t <span class="token operator">==</span> e <span class="token operator">&amp;&amp;</span> e <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> key <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> l <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> t <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> e<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">+=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">+=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">+=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> t<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">23L</span><span class="token punctuation">;</span>        cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">%</span> <span class="token number">1_000_000_007</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T4-è´­ä¹°ç‰©å“çš„æœ€å¤§å¼€é”€"><a href="#T4-è´­ä¹°ç‰©å“çš„æœ€å¤§å¼€é”€" class="headerlink" title="T4. è´­ä¹°ç‰©å“çš„æœ€å¤§å¼€é”€"></a><a href="https://leetcode.cn/contest/biweekly-contest-117/problems/maximum-spending-after-buying-items/">T4. è´­ä¹°ç‰©å“çš„æœ€å¤§å¼€é”€</a></h5><p>å¤šè·¯å½’å¹¶çš„æ¿å­é¢˜ï¼Œä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè®°å½•å¥½å±äºå“ªä¸ªç»„åŠå…¶åœ¨ç»„ä¸­çš„ä¸‹æ ‡å³å¯</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">maxSpending</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> o1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> o2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> o1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> o2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tmp <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ans <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> index<span class="token operator">++</span> <span class="token operator">*</span> tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> values<span class="token punctuation">[</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨ç®—æ³•æ¨¡æ¿ï¼ˆå¯æŠ„</title>
      <link href="/2023/11/09/algorithm-template/"/>
      <url>/2023/11/09/algorithm-template/</url>
      
        <content type="html"><![CDATA[<h5 id="äºŒåˆ†"><a href="#äºŒåˆ†" class="headerlink" title="äºŒåˆ†"></a>äºŒåˆ†</h5><p>ä»¥ä¸‹ä¸‰ç§æŸ¥æ‰¾èŒƒå›´å‡ä¸º [0, N]</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é—­åŒºé—´ï¼š[left, right]</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binary</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// å·¦é—­å³å¼€ï¼š[left, right)</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binary</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            right <span class="token operator">=</span> mid<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// å·¦å¼€å³é—­ï¼š(left, right]</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binary</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">=</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            left <span class="token operator">=</span> mid<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> left<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// å¼€åŒºé—´ï¼š(left, right)</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binary</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            left <span class="token operator">=</span> mid<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            right <span class="token operator">=</span> mid<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> left<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h5><p>è¾“å…¥ä¸¤ä¸ªæ•°ï¼Œè¿”å›ä»–ä»¬çš„æœ€å¤§å…¬çº¦æ•°</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> a <span class="token operator">%</span> b<span class="token punctuation">;</span>        a <span class="token operator">=</span> b<span class="token punctuation">;</span>        b <span class="token operator">=</span> temp<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">UnionFind</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parents<span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sizes<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        parents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            parents<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        sizes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>sizes<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>parents<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> x<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            parents<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>parents<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> parents<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> rx <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> ry <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>rx <span class="token operator">!=</span> ry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            parents<span class="token punctuation">[</span>ry<span class="token punctuation">]</span> <span class="token operator">=</span> rx<span class="token punctuation">;</span>            sizes<span class="token punctuation">[</span>rx<span class="token punctuation">]</span> <span class="token operator">+=</span> sizes<span class="token punctuation">[</span>ry<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> sizes<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="TrieTree"><a href="#TrieTree" class="headerlink" title="TrieTree"></a>TrieTree</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TrieTree</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">TrieNode</span> root<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">TrieTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æ’å…¥ str å­—ç¬¦ä¸²</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">TrieNode</span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>        node<span class="token punctuation">.</span>pass<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>            node<span class="token punctuation">.</span>pass<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        node<span class="token punctuation">.</span>end<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// åˆ é™¤ str å­—ç¬¦ä¸²</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">search</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">TrieNode</span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>        node<span class="token punctuation">.</span>pass<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>pass <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        node<span class="token punctuation">.</span>end<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æŸ¥è¯¢ str å­—ç¬¦ä¸²å‡ºç°è¿‡çš„æ¬¡æ•°</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">TrieNode</span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> node<span class="token punctuation">.</span>end<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æŸ¥è¯¢ str å­—ç¬¦ä¸²ä½œä¸ºå‰ç¼€çš„æ¬¡æ•°</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">prefixNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">TrieNode</span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> node<span class="token punctuation">.</span>pass<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">TrieNode</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> pass<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> end<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token class-name">TrieNode</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next<span class="token punctuation">;</span> <span class="token comment">// å½“å­—ç¬¦ç§ç±»å¤ªå¤šæ—¶ï¼Œä½¿ç”¨HashMap&lt;Char, TrieNode> next;</span>        <span class="token keyword">public</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            pass <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä¾‹é¢˜ï¼šhttps://leetcode.cn/problems/maximum-xor-of-two-numbers-in-an-array/description/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Morris"><a href="#Morris" class="headerlink" title="Morris"></a>Morris</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">morris</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">TreeNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> mostRight<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        mostRight <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> cur<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight <span class="token operator">=</span> mostRight<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// mostRightçš„å³å­©å­æ˜¯nullï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡éå†åˆ°cur</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> cur<span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// mostRightçš„å³å­©å­æ˜¯curï¼Œè¯´æ˜æ˜¯ç¬¬äºŒæ¬¡éå†åˆ°cur</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">morrisPre</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">TreeNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> mostRight<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        mostRight <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> cur<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight <span class="token operator">=</span> mostRight<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç¬¬ä¸€æ¬¡éå†curæ—¶å…ˆæ‰“å°</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> cur<span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ²¡æœ‰å·¦å­æ ‘æ—¶</span>        <span class="token punctuation">&#125;</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">morrisIn</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">TreeNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> mostRight<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        mostRight <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> cur<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight <span class="token operator">=</span> mostRight<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> cur<span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">morrisPos</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">TreeNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> mostRight<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        mostRight <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mostRight<span class="token punctuation">.</span>right <span class="token operator">!=</span> cur<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight <span class="token operator">=</span> mostRight<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mostRight<span class="token punctuation">.</span>right  <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> cur<span class="token punctuation">;</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                mostRight<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token function">printEdge</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€†åºæ‰“å°å·¦å­©å­çš„å³è¾¹ç•Œ</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printEdge</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€†åºæ‰“å°å¤´èŠ‚ç‚¹çš„å³è¾¹ç•Œ</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">printEdge</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">TreeNode</span> tail <span class="token operator">=</span> <span class="token function">reverseEdge</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> cur <span class="token operator">=</span> tail<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">reverseEdge</span><span class="token punctuation">(</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token class-name">TreeNode</span> <span class="token function">reverseEdge</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">TreeNode</span> next<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span> pre <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        next <span class="token operator">=</span> node<span class="token punctuation">.</span>right<span class="token punctuation">;</span>        node<span class="token punctuation">.</span>right <span class="token operator">=</span> pre<span class="token punctuation">;</span>        pre <span class="token operator">=</span> node<span class="token punctuation">;</span>        node <span class="token operator">=</span> next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> pre<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­çš„æœ€é•¿å›æ–‡å­—ä¸² * 122131221 * ç»å…¸è§£æ³•ï¼šä»¥æŸä¸ªä½ç½®å‘å·¦å³ä¸¤è¾¹æ‰©å……æ¯”è¾ƒ * ç¼ºé™·ï¼šåªèƒ½æ‰¾åˆ°é•¿åº¦ä¸ºå¥‡æ•°çš„å›æ–‡å­—ç¬¦ä¸²ï¼Œæ— æ³•æ­£ç¡®å¾—åˆ°é•¿åº¦ä¸ºå¶æ•°çš„å›æ–‡å­—ç¬¦ä¸² * æ”¹è¿›ï¼šåœ¨åŸå­—ç¬¦ä¸²ä¸­åŠ å…¥è¾…åŠ©å­—ç¬¦ï¼Œä¾‹å¦‚#1#2#2#1#3#1#2#2#1# * è§£æ³•ï¼šæ±‚å‡ºæ¯ä¸ªä½ç½®å‘å·¦å³ä¸¤è¾¹æ‰©å……æ¯”è¾ƒçš„å›æ–‡å­—ç¬¦ä¸²çš„é•¿åº¦åœ¨ / 2 å³ä¸ºæ­£ç¡®ç­”æ¡ˆ * æ³¨æ„ï¼šè¾…åŠ©å­—ç¬¦å¿…é¡»æ˜¯åŸå­—ç¬¦ä¸²ä¸­æœªå‡ºç°çš„å­—ç¬¦å— * ç­”æ¡ˆï¼šä¸éœ€è¦ï¼Œè¾…åŠ©å­—ç¬¦å¯ä»¥æ˜¯ä»»ä¸€å­—ç¬¦ï¼Œå› ä¸ºåœ¨å·¦å³æ‰©å……æ¯”è¾ƒæ—¶ï¼Œè¾…åŠ©å­—ç¬¦åªä¼šå’Œè¾…åŠ©å­—ç¬¦æ¯”è¾ƒï¼ŒåŸå­—ç¬¦åªä¼šå’ŒåŸå­—ç¬¦æ¯”è¾ƒï¼Œä¸å½±å“ç»“æœ * æ—¶é—´å¤æ‚åº¦ï¼šO(N^2) */</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxLcpsLength</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cArr <span class="token operator">=</span> <span class="token function">manacherString</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>cArr<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å›æ–‡åŠå¾„æ•°ç»„</span>    <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// å›æ–‡ä¸­å¿ƒ</span>    <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// å›æ–‡å³è¾¹ç•Œå†å‘å³ä¸€ä¸ªä½ç½®ï¼Œå›æ–‡å³è¾¹ç•Œå®é™…ä¸ºr-1</span>    <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ç»“æœ</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> cArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r <span class="token operator">></span> i <span class="token operator">?</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>rArr<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> c <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// iä½ç½®è‡³å°‘çš„å›æ–‡åŒºåŸŸ</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> cArr<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> i <span class="token operator">-</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>i <span class="token operator">+</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> cArr<span class="token punctuation">[</span>i <span class="token operator">-</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            r <span class="token operator">=</span> i <span class="token operator">+</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            c <span class="token operator">=</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> rArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> max <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">manacherString</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> charArr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> res<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token char">'#'</span> <span class="token operator">:</span> charArr<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIndexOf</span><span class="token punctuation">(</span><span class="token class-name">String</span> n<span class="token punctuation">,</span> <span class="token class-name">String</span> m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> m <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> m<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> n<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> m<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str1 <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str2 <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token function">getNextArray</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i1 <span class="token operator">&lt;</span> str1<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> i2 <span class="token operator">&lt;</span> str2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str1<span class="token punctuation">[</span>i1<span class="token punctuation">]</span> <span class="token operator">==</span> str2<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ª</span>            i1<span class="token operator">++</span><span class="token punctuation">;</span>            i2<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>next<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// str2å·²ç»æ— æ³•å‘å‰ç§»åŠ¨</span>            i1<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// str2å‘å‰ç§»åŠ¨åˆ°å‰ç¼€çš„ä¸‹ä¸€ä¸ªä½ç½®</span>            i2 <span class="token operator">=</span> next<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> i2 <span class="token operator">==</span> str2<span class="token punctuation">.</span>length <span class="token operator">?</span> i1 <span class="token operator">-</span> i2 <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getNextArray</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>    next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    next<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> cn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> str<span class="token punctuation">[</span>cn<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// cnä½ç½®çš„å­—ç¬¦ == i-1ä½ç½®çš„å­—ç¬¦</span>            next<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>cn<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cn <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// cnä½ç½®çš„å­—ç¬¦ != i-1ä½ç½®çš„å­—ç¬¦</span>            cn <span class="token operator">=</span> next<span class="token punctuation">[</span>cn<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// cn == 0</span>            next<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * åœ¨å»ºå›¾æ—¶ï¼Œæ¯”å¦‚ï¼šç‚¹Aå’Œç‚¹Aä¹‹é—´çš„æƒå€¼å¿…é¡»å¤„ç†ä¸º0ï¼Œå³ç‚¹ä¸è‡ªèº«çš„æƒå€¼å¿…é¡»ä¸º0 * è¯¥å›¾ä¸ºæ— å‘å›¾ */</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> edges<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">==</span> j <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> e <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> a <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        g<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * æ±‚å‡ºå›¾ä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦» * PSï¼šé€‚ç”¨äºé™¤æœ‰è´Ÿç¯ä¹‹å¤–çš„æ‰€æœ‰å›¾ï¼Œæ¢è¨€ä¹‹ï¼Œä¸è®ºæœ‰å‘æ— å‘ï¼Œæ— è®ºè¾¹æƒæ­£è´Ÿï¼Œä¸èƒ½æœ‰è´Ÿç¯å³å¯ï¼ˆä¿è¯æœ€çŸ­è·¯å­˜åœ¨ï¼‰ * æ—¶é—´å¤æ‚åº¦ï¼šO(n^3) ç©ºé—´å¤æ‚åº¦ï¼šO(n^2) * æ‰€ä»¥åªé€‚ç”¨äºå°å›¾ï¼Œä¾‹å¦‚èŠ‚ç‚¹æ•°å°äº100 */</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">floyd</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> g<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> g<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token comment">// åŸºæœ¬æµç¨‹ä¸ºï¼šå¿…é¡»å…ˆæšä¸¾ä¸­é—´ç‚¹ï¼Œå†æšä¸¾èµ·ç‚¹ï¼Œæœ€åæšä¸¾ç»ˆç‚¹</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> b <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> b<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">+</span> g<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä¾‹é¢˜ï¼šhttps://leetcode.cn/problems/find-the-city-with-the-smallest-number-of-neighbors-at-a-threshold-distance/description/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * åœ¨å»ºå›¾æ—¶ï¼Œæ¯”å¦‚ï¼šç‚¹Aå’Œç‚¹Aä¹‹é—´çš„æƒå€¼å¿…é¡»å¤„ç†ä¸º0ï¼Œå³ç‚¹ä¸è‡ªèº«çš„æƒå€¼å¿…é¡»ä¸º0 * è¯¥å›¾ä¸ºæœ‰å‘å›¾ */</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> edges<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">==</span> j <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> e <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> a <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        g<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * ç»™å®šä¸€ä¸ªèµ·å§‹ç‚¹ï¼Œæ±‚è§£ä»èµ·å§‹ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ * PSï¼šä»…é€‚ç”¨äºè¾¹çš„æƒå€¼æ²¡æœ‰è´Ÿæ•°çš„å›¾ï¼Œä¸è®ºæœ‰å‘æ— å‘ * æ—¶é—´å¤æ‚åº¦ï¼š * æ™®é€šï¼šO(n^2) * å †ä¼˜åŒ–ï¼šO(m*logm) * åå‘ç´¢å¼•å †ä¼˜åŒ–ï¼šO(mlogn) å…¶ä¸­mä¸ºè¾¹æ•°ï¼Œnä¸ºç‚¹æ•° * * å…¥å‚aä¸ºèµ·å§‹ç‚¹ */</span><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> g<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> g<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dis<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> heap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>o <span class="token operator">-></span> o<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    heap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>heap<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> b <span class="token operator">=</span> heap<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>vis<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        vis<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dis<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">+</span> g<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">+</span> g<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                heap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">,</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> dis<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä¾‹é¢˜ï¼šhttps://leetcode.cn/problems/network-delay-time/description/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 370 åœºå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/11/05/weekly-contest-370/"/>
      <url>/2023/11/05/weekly-contest-370/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>T1ã€T2 æƒ³åäº†ï¼Œè®²é“ç†å‰ä¸¤é“é¢˜ä¸å¯èƒ½è€ƒå¯Ÿå¹¶æŸ¥é›†çš„ï¼Œå‰ä¸¤é¢˜æ²¡æƒ³åˆ°ç®€å•åšæ³•ï¼Œæœ€åç”¨å¹¶æŸ¥é›†å†™çš„ï¼Œè¿˜å†™å‡ºäº† bug è¢«ç½šæ—¶äº† 4 æ¬¡ï¼Œå¯¼è‡´å‰ä¸¤é¢˜å†™çš„å¾ˆæ…¢ï¼Œä»¥åå‘¨èµ›è¦é“­è®°å‰ä¸¤é¢˜å¤§å¤šéƒ½æ˜¯æ€ç»´é¢˜åˆ«æƒ³åã€‚T3 æƒ³äº† 30 åˆ†é’Ÿæ”¾å¼ƒäº†ï¼Œæƒ³åˆ°äº†æ­£éš¾åˆ™åå’Œ dfsï¼Œä½†æ˜¯æ²¡æ³•è¿èµ·æ¥ï¼Œåˆæ‰å¤§åˆ†å’¯ã€‚</p><p><img src="https://s2.loli.net/2023/11/05/nxRVu4YIcj3ieha.png"></p><h5 id="T1-æ‰¾åˆ°å† å†›-I"><a href="#T1-æ‰¾åˆ°å† å†›-I" class="headerlink" title="T1. æ‰¾åˆ°å† å†› I"></a><a href="https://leetcode.cn/contest/weekly-contest-370/problems/find-champion-i/">T1. æ‰¾åˆ°å† å†› I</a></h5><p>åˆ¤æ–­æŸä¸€åˆ—æ˜¯å¦å…¨ä¸º 0ï¼Œè¡¨ç¤ºæ²¡æœ‰é˜Ÿä¼æ¯”è¯¥é˜Ÿå¼º</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findChampion</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> j <span class="token operator">&amp;&amp;</span> grid<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T2-æ‰¾åˆ°å† å†›-II"><a href="#T2-æ‰¾åˆ°å† å†›-II" class="headerlink" title="T2. æ‰¾åˆ°å† å†› II"></a><a href="https://leetcode.cn/contest/weekly-contest-370/problems/find-champion-ii/">T2. æ‰¾åˆ°å† å†› II</a></h5><p>è‹¥åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ä¸º 0ï¼Œåˆ™è¾“å‡ºè¿™ä¸ªèŠ‚ç‚¹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findChampion</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> help <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            help<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>help<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>ans <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                ans <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-åœ¨æ ‘ä¸Šæ‰§è¡Œæ“ä½œä»¥åå¾—åˆ°çš„æœ€å¤§åˆ†æ•°"><a href="#T3-åœ¨æ ‘ä¸Šæ‰§è¡Œæ“ä½œä»¥åå¾—åˆ°çš„æœ€å¤§åˆ†æ•°" class="headerlink" title="T3. åœ¨æ ‘ä¸Šæ‰§è¡Œæ“ä½œä»¥åå¾—åˆ°çš„æœ€å¤§åˆ†æ•°"></a><a href="https://leetcode.cn/contest/weekly-contest-370/problems/maximum-score-after-applying-operations-on-a-tree/">T3. åœ¨æ ‘ä¸Šæ‰§è¡Œæ“ä½œä»¥åå¾—åˆ°çš„æœ€å¤§åˆ†æ•°</a></h5><p>æ­£éš¾åˆ™åï¼Œå…ˆå°†æ‰€æœ‰ values åŠ å…¥åˆ°ç­”æ¡ˆä¸­ï¼Œç„¶åè®¨è®ºé€‰æˆ–ä¸é€‰çš„é—®é¢˜</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">maximumScoreAfterOperations</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">[</span>values<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            g<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        g<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>            g<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ans <span class="token operator">+=</span> v<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> ans <span class="token operator">-</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> g<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> par<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> g<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>g<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> values<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">long</span> loss <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">:</span> g<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">!=</span> par<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                loss <span class="token operator">+=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> index<span class="token punctuation">,</span> g<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 116 åœºåŒå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/10/31/biweekly-contest-116/"/>
      <url>/2023/10/31/biweekly-contest-116/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>T2 åˆç†è§£é”™é¢˜æ„äº†ï¼Œä¸€æäº¤çœ‹åˆ°é”™è¯¯æ ·ä¾‹æ‰æ˜ç™½é¢˜ç›®æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå’±å°±æ˜¯è¯´ä»¥åçœ‹é¢˜èƒ½ä¸èƒ½åˆ«æ€¥ã€‚æ­¤å¤–æ€»ç»“é‡åˆ° dp å°±å¯„ï¼ŒT3 ä¸€é“å¾ˆç»å…¸çš„èƒŒåŒ…é—®é¢˜ï¼Œåœ¨å†™å®Œé€’å½’ä»¥åæ”¹ä¸å‡ºè®°å¿†åŒ–æœç´¢ä¸€ç›´è¶…æ—¶ï¼Œæ‰å¤§åˆ†çš„ä¸€åœºã€‚</p><p><img src="https://s2.loli.net/2023/10/31/s3VjSgLUTEkdlAK.png"></p><h5 id="T1-å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ-I"><a href="#T1-å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ-I" class="headerlink" title="T1. å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ I"></a><a href="https://leetcode.cn/contest/biweekly-contest-116/problems/subarrays-distinct-element-sum-of-squares-i/">T1. å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ I</a></h5><p>åŒ T4</p><h5 id="T2-ä½¿äºŒè¿›åˆ¶å­—ç¬¦ä¸²å˜ç¾ä¸½çš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°"><a href="#T2-ä½¿äºŒè¿›åˆ¶å­—ç¬¦ä¸²å˜ç¾ä¸½çš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°" class="headerlink" title="T2. ä½¿äºŒè¿›åˆ¶å­—ç¬¦ä¸²å˜ç¾ä¸½çš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°"></a><a href="https://leetcode.cn/contest/biweekly-contest-116/problems/minimum-number-of-changes-to-make-binary-string-beautiful/">T2. ä½¿äºŒè¿›åˆ¶å­—ç¬¦ä¸²å˜ç¾ä¸½çš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°</a></h5><p>æ€ç»´é¢˜ï¼Œå…³é”®ä¿¡æ¯æ˜¯å­—ä¸²çš„é•¿åº¦ä¸ºå¶æ•°ï¼Œæ‰€ä»¥åªéœ€è¦ä¸¤ä¸¤ç›¸æ¯”å°±å¯ä»¥äº†</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minChanges</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦"><a href="#T3-å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦" class="headerlink" title="T3. å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦"></a><a href="https://leetcode.cn/contest/biweekly-contest-116/problems/length-of-the-longest-subsequence-that-sums-to-target/">T3. å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦</a></h5><p>ç»å…¸ 0-1 èƒŒåŒ…é—®é¢˜ï¼Œä¸å¤šè¯´äº†ï¼Œç»§ç»­å»ç»ƒäº†</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLongestSubsequence</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>target <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MIN_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            s <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>s <span class="token operator">+</span> x<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> s<span class="token punctuation">;</span> j <span class="token operator">>=</span> x<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                f<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>j <span class="token operator">-</span> x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> f<span class="token punctuation">[</span>target<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> f<span class="token punctuation">[</span>target<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T4-å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ-II"><a href="#T4-å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ-II" class="headerlink" title="T4. å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ II"></a><a href="https://leetcode.cn/contest/biweekly-contest-116/problems/subarrays-distinct-element-sum-of-squares-ii/">T4. å­æ•°ç»„ä¸åŒå…ƒç´ æ•°ç›®çš„å¹³æ–¹å’Œ II</a></h5><p>ç”¨åˆ°äº† lazy çº¿æ®µæ ‘å¹¶ä¸”éœ€è¦æ¨åˆ°æ•°å­¦å…¬å¼ï¼Œlazy çº¿æ®µæ ‘å…ˆæ¬ ç€ï¼ŒåŸºç¡€ç®—æ³•æ‰å®äº†å†æ¥çœ‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sum<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> todo<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">sumCounts</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        sum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span>n <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        todo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> j <span class="token operator">=</span> last<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            s <span class="token operator">+=</span> <span class="token function">queryAndAdd1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> i <span class="token operator">-</span> j<span class="token punctuation">;</span>            ans <span class="token operator">=</span> <span class="token punctuation">(</span>ans <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">1_000_000_007</span><span class="token punctuation">;</span>            last<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">do_</span><span class="token punctuation">(</span><span class="token keyword">int</span> o<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> add<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        sum<span class="token punctuation">[</span>o<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> add <span class="token operator">*</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        todo<span class="token punctuation">[</span>o<span class="token punctuation">]</span> <span class="token operator">+=</span> add<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// o=1  [l,r] 1&lt;=l&lt;=r&lt;=n</span>    <span class="token comment">// æŠŠ [L,R] åŠ ä¸€ï¼ŒåŒæ—¶è¿”å›åŠ ä¸€ä¹‹å‰çš„åŒºé—´å’Œ</span>    <span class="token keyword">private</span> <span class="token keyword">long</span> <span class="token function">queryAndAdd1</span><span class="token punctuation">(</span><span class="token keyword">int</span> o<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token class-name">L</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token class-name">R</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">L</span> <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> <span class="token class-name">R</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">long</span> res <span class="token operator">=</span> sum<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token function">do_</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> add <span class="token operator">=</span> todo<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>add <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">do_</span><span class="token punctuation">(</span>o <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> add<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">do_</span><span class="token punctuation">(</span>o <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> add<span class="token punctuation">)</span><span class="token punctuation">;</span>            todo<span class="token punctuation">[</span>o<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">L</span> <span class="token operator">&lt;=</span> m<span class="token punctuation">)</span> res <span class="token operator">+=</span> <span class="token function">queryAndAdd1</span><span class="token punctuation">(</span>o <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> <span class="token class-name">R</span><span class="token punctuation">)</span>  res <span class="token operator">+=</span> <span class="token function">queryAndAdd1</span><span class="token punctuation">(</span>o <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sum<span class="token punctuation">[</span>o<span class="token punctuation">]</span> <span class="token operator">=</span> sum<span class="token punctuation">[</span>o <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> sum<span class="token punctuation">[</span>o <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 368 åœºå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/10/23/weekly-contest-368/"/>
      <url>/2023/10/23/weekly-contest-368/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>è¿™åœº T1ã€T2 çœ‹é”™é¢˜äº†ï¼Œå¯¼è‡´20åˆ†é’Ÿæ²¡ A å‡ºæ¥ï¼Œåæ¥çœ‹æ¸…é¢˜æ„ä¸åˆ° 10 åˆ†é’Ÿå°±å†™å‡ºæ¥äº†ï¼Œå¯æƒœï¼ŒT3 è¢«ç»•è¿›å»äº†ï¼Œdebug äº†ä¸€ä¸ªå°æ—¶ä¹Ÿæ²¡å†™å¯¹ï¼ŒT4 ä¸€çœ‹ 7 åˆ†ç›´æ¥æ”¾å¼ƒäº†å“ˆå“ˆã€‚</p><p>PSï¼šå°æ‰äº† 5 åˆ†ï¼Œå¦‚æœä¸çœ‹é”™é¢˜ï¼Œå‰ä¸¤é¢˜å†™å¿«ä¸€ç‚¹ï¼Œè¿™å‘¨åº”è¯¥ 1700 äº†ï¼Œå¯æƒœã€‚</p><p><img src="https://s2.loli.net/2023/10/23/FDoLsglBvZi4TJ5.png"></p><h5 id="T1-å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„-I"><a href="#T1-å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„-I" class="headerlink" title="T1. å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„ I"></a><a href="https://leetcode.cn/circle/discuss/bPzSQn/">T1. å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„ I</a></h5><p>åŒ T2</p><h5 id="T2-å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„-II"><a href="#T2-å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„-II" class="headerlink" title="T2. å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„ II"></a><a href="https://leetcode.cn/circle/discuss/bPzSQn/">T2. å…ƒç´ å’Œæœ€å°çš„å±±å½¢ä¸‰å…ƒç»„ II</a></h5><p>ç»å…¸å‰åç¼€åˆ†è§£ï¼Œéå†æ—¶ä¹Ÿæ˜¯ä»å‰å¾€åï¼Œæ‰€ä»¥å‰ç¼€å¯ä»¥ä¸ç”¨æ•°ç»„å­˜å‚¨</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimumSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> suf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        suf<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            suf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>suf<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> pre <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>pre <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> suf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> pre <span class="token operator">+</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> suf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            pre <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>pre<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-åˆæ³•åˆ†ç»„çš„æœ€å°‘ç»„æ•°"><a href="#T3-åˆæ³•åˆ†ç»„çš„æœ€å°‘ç»„æ•°" class="headerlink" title="T3. åˆæ³•åˆ†ç»„çš„æœ€å°‘ç»„æ•°"></a><a href="https://leetcode.cn/contest/weekly-contest-368/problems/minimum-number-of-groups-to-create-a-valid-assignment/">T3. åˆæ³•åˆ†ç»„çš„æœ€å°‘ç»„æ•°</a></h5><p>ä»å‡ºç°æ¬¡æ•°æœ€å°‘çš„æ•°å¼€å§‹å‘ä¸‹æšä¸¾ï¼Œéš¾ç‚¹åœ¨äºæ€ä¹ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³è¦æ±‚å³ï¼š<code>c / k &lt; c % k</code> èµ›æ—¶æ²¡å†™å¯¹è¿™ä¸ªå…¬å¼</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minGroupsForValidAssignment</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> cnt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cnt<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">sum</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> k <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">:</span> cnt<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            k <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> k<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">:</span> cnt<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">/</span> k <span class="token operator">&lt;</span> c <span class="token operator">%</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                ans <span class="token operator">+=</span> <span class="token punctuation">(</span>c <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ans <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> ans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºå•¥ onMeasure æ‰§è¡Œä¸¤æ¬¡å‘¢</title>
      <link href="/2023/10/22/onMeasure-more-than-once/"/>
      <url>/2023/10/22/onMeasure-more-than-once/</url>
      
        <content type="html"><![CDATA[<h5 id="é¦–å…ˆæ¥çœ‹çœ‹-view-çš„åŠ è½½æµç¨‹"><a href="#é¦–å…ˆæ¥çœ‹çœ‹-view-çš„åŠ è½½æµç¨‹" class="headerlink" title="é¦–å…ˆæ¥çœ‹çœ‹ view çš„åŠ è½½æµç¨‹"></a>é¦–å…ˆæ¥çœ‹çœ‹ view çš„åŠ è½½æµç¨‹</h5><p>åœ¨ä¸€èˆ¬æ€§è¿‡ç¨‹ä¸­ï¼Œview éƒ½ä¼šç»å†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// WindowManagerGlobal.class</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addView</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">,</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span> params<span class="token punctuation">,</span>                     <span class="token class-name">Display</span> display<span class="token punctuation">,</span> <span class="token class-name">Window</span> parentWindow<span class="token punctuation">,</span> <span class="token keyword">int</span> userId<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">final</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span> wparams <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">)</span> params<span class="token punctuation">;</span>    <span class="token class-name">ViewRootImpl</span> root<span class="token punctuation">;</span>    <span class="token class-name">View</span> panelParentView <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mLock<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// æ„é€  ViewRootImpl å¯¹è±¡</span>        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ViewRootImpl</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> display<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å°†ä¼ è¿›æ¥çš„ wparams ä½œä¸º rootView çš„å‚æ•°</span>        view<span class="token punctuation">.</span><span class="token function">setLayoutParams</span><span class="token punctuation">(</span>wparams<span class="token punctuation">)</span><span class="token punctuation">;</span>        mViews<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>        mRoots<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        mParams<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>wparams<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// do this last because it fires off messages to start doing things</span>        <span class="token comment">// å®é™…çš„ view ç»˜åˆ¶æµç¨‹åœ¨ ViewRootImpl ä¸­è¿›è¡Œ</span>        root<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span>view<span class="token punctuation">,</span> wparams<span class="token punctuation">,</span> panelParentView<span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆä¼šåœ¨ WindowManagerGlobal ä¸­åˆ›å»º ViewRootImpl å¯¹è±¡ï¼Œå¹¶è®¾ç½® LayoutParamsï¼Œç„¶åä¼ å…¥ ViewRootImpl ä¸­è¿›è¡Œå¤„ç†ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.class</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setView</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">,</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span> attrs<span class="token punctuation">,</span> <span class="token class-name">View</span> panelParentView<span class="token punctuation">,</span>                    <span class="token keyword">int</span> userId<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mView <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            mView <span class="token operator">=</span> view<span class="token punctuation">;</span>            <span class="token comment">// attrs å‚æ•°ä¼šæ‹·è´åˆ° window çš„å‚æ•°ä¸­å»ï¼Œåç»­ä¼šä½¿ç”¨</span>            mWindowAttributes<span class="token punctuation">.</span><span class="token function">copyFrom</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Schedule the first layout -before- adding to the window</span>            <span class="token comment">// manager, to make sure we do the relayout before receiving</span>            <span class="token comment">// any other events from the system.</span>            <span class="token comment">// å¼€å§‹ç»˜åˆ¶ view çš„ä¸‰ä¸ªæµç¨‹</span>            <span class="token function">requestLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ä¸Šè¾¹æ‹·è´è¿› window ä¸­çš„ attrs å‚æ•°ï¼Œä¹Ÿä¼šç”¨æ¥çº¦æŸ window çš„å¤§å°</span>            <span class="token keyword">int</span> res<span class="token punctuation">;</span> <span class="token comment">/* = WindowManagerImpl.ADD_OKAY; */</span>            res <span class="token operator">=</span> mWindowSession<span class="token punctuation">.</span><span class="token function">addToDisplayAsUser</span><span class="token punctuation">(</span>mWindow<span class="token punctuation">,</span> mWindowAttributes<span class="token punctuation">,</span>                                                    <span class="token function">getHostVisibility</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mDisplay<span class="token punctuation">.</span><span class="token function">getDisplayId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> userId<span class="token punctuation">,</span>                                                    mInsetsController<span class="token punctuation">.</span><span class="token function">getRequestedVisibleTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inputChannel<span class="token punctuation">,</span> mTempInsets<span class="token punctuation">,</span>                                                    mTempControls<span class="token punctuation">,</span> attachedFrame<span class="token punctuation">,</span> compatScale<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ ViewRootImpl ä¸­ä¼šå…ˆå°†çº¦æŸ rootView çš„å‚æ•°æ‹·è´è¿› window ä¸­ï¼Œå¹¶ä¸”ä¹Ÿä¼šç”¨æ¥çº¦æŸ window çš„å¤§å°ï¼Œéšå <code>requestLayout()</code> ä¼šå‘é€ä¸€ä¸ª runnable å¹¶ç­‰å¾…ä¸»çº¿ç¨‹æ”¶åˆ°ä¿¡å·æ—¶å¼€å§‹æ‰§è¡Œ <code>performTraversals()</code> å¼€å¯ç»˜åˆ¶æµç¨‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.class</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">performTraversals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span> lp <span class="token operator">=</span> mWindowAttributes<span class="token punctuation">;</span>    <span class="token comment">// window æ‰€æœŸæœ›çš„å®½é«˜</span>    <span class="token keyword">int</span> desiredWindowWidth<span class="token punctuation">;</span>    <span class="token keyword">int</span> desiredWindowHeight<span class="token punctuation">;</span>    <span class="token class-name">Rect</span> frame <span class="token operator">=</span> mWinFrame<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mFirst<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        desiredWindowWidth <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        desiredWindowHeight <span class="token operator">=</span> frame<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">boolean</span> layoutRequested <span class="token operator">=</span> mLayoutRequested <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>mStopped <span class="token operator">||</span> mReportNextDraw<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>layoutRequested<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Ask host how big it wants to be</span>        <span class="token comment">// å¼€å§‹æµ‹é‡ viewTree</span>        windowSizeMayChange <span class="token operator">|=</span> <span class="token function">measureHierarchy</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> lp<span class="token punctuation">,</span> mView<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                                desiredWindowWidth<span class="token punctuation">,</span> desiredWindowHeight<span class="token punctuation">,</span> shouldOptimizeMeasure<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mFirst <span class="token operator">||</span> windowShouldResize <span class="token operator">||</span> viewVisibilityChanged <span class="token operator">||</span> params <span class="token operator">!=</span> <span class="token keyword">null</span>                <span class="token operator">||</span> mForceNextWindowRelayout<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// é‡æ–°ç¡®å®š window çš„å¤§å°</span>    relayoutResult <span class="token operator">=</span> <span class="token function">relayoutWindow</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> viewVisibility<span class="token punctuation">,</span> insetsPending<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mWidth <span class="token operator">!=</span> host<span class="token punctuation">.</span><span class="token function">getMeasuredWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> mHeight <span class="token operator">!=</span> host<span class="token punctuation">.</span><span class="token function">getMeasuredHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token operator">||</span> dispatchApplyInsets <span class="token operator">||</span> updatedConfiguration<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å†æ¬¡æµ‹é‡ viewTree</span>        <span class="token function">performMeasure</span><span class="token punctuation">(</span>childWidthMeasureSpec<span class="token punctuation">,</span> childHeightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>        layoutRequested <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">performLayout</span><span class="token punctuation">(</span>lp<span class="token punctuation">,</span> mWidth<span class="token punctuation">,</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">performDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆä¼šæ‰§è¡Œ <code>measureHierarchy()</code> æµ‹é‡ viewTreeï¼Œæ ¹æ®å…¶è¿”å›å€¼åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°ç¡®å®š window çš„å¤§å°ï¼Œç„¶åä¼šæ‰§è¡Œ <code>performMeasure()</code> æ¥å†æ¬¡æµ‹é‡ viewTreeï¼Œé‚£ä¹ˆä¸¤æ¬¡æµ‹é‡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¯·ç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.class</span><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">measureHierarchy</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">View</span> host<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span> lp<span class="token punctuation">,</span>                                 <span class="token keyword">final</span> <span class="token class-name">Resources</span> res<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> desiredWindowWidth<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> desiredWindowHeight<span class="token punctuation">,</span>                                 <span class="token keyword">boolean</span> forRootSizeOnly<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> childWidthMeasureSpec<span class="token punctuation">;</span>    <span class="token keyword">int</span> childHeightMeasureSpec<span class="token punctuation">;</span>    <span class="token comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°ç¡®å®š window çš„å¤§å°</span>    <span class="token keyword">boolean</span> windowSizeMayChange <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// æ ‡è®°æ˜¯å¦æµ‹é‡æˆåŠŸ</span>    <span class="token keyword">boolean</span> goodMeasure <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">// å¯è§å¦‚æœå®½é«˜ä¸º WRAP_CONTENT æ—¶ï¼Œå¯èƒ½ä¼šå†é¢å¤–å¤šå‡ æ¬¡æµ‹é‡</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>lp<span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">WRAP_CONTENT</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// On large screens, we don't want to allow dialogs to just</span>        <span class="token comment">// stretch to fill the entire width of the screen to display</span>        <span class="token comment">// one line of text.  First try doing the layout at a smaller</span>        <span class="token comment">// size to see if it will fit.</span>        <span class="token keyword">final</span> <span class="token class-name">DisplayMetrics</span> packageMetrics <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getDisplayMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>config_prefDialogWidth<span class="token punctuation">,</span> mTmpValue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// çˆ¶å¸ƒå±€ç»™é¢„ç•™çš„å®½é«˜</span>        <span class="token keyword">int</span> baseSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mTmpValue<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token class-name">TypedValue</span><span class="token punctuation">.</span><span class="token constant">TYPE_DIMENSION</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            baseSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>mTmpValue<span class="token punctuation">.</span><span class="token function">getDimension</span><span class="token punctuation">(</span>packageMetrics<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¦‚æœé¢„ç•™çš„å®½é«˜ä¸è¶³æ—¶ï¼Œåˆ™ä¼šè¿›è¡Œæµ‹é‡</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>baseSize <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> desiredWindowWidth <span class="token operator">></span> baseSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            childWidthMeasureSpec <span class="token operator">=</span> <span class="token function">getRootMeasureSpec</span><span class="token punctuation">(</span>baseSize<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>width<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>privateFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>            childHeightMeasureSpec <span class="token operator">=</span> <span class="token function">getRootMeasureSpec</span><span class="token punctuation">(</span>desiredWindowHeight<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>height<span class="token punctuation">,</span>                                                        lp<span class="token punctuation">.</span>privateFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ç¬¬ä¸€æ¬¡æµ‹é‡</span>            <span class="token function">performMeasure</span><span class="token punctuation">(</span>childWidthMeasureSpec<span class="token punctuation">,</span> childHeightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// æµ‹é‡çš„å°ºå¯¸å°äºè§†å›¾æƒ³è¦çš„å°ºå¯¸</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">.</span><span class="token function">getMeasuredWidthAndState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">MEASURED_STATE_TOO_SMALL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                goodMeasure <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// Didn't fit in that size... try expanding a bit.</span>                <span class="token comment">// å°è¯•æ‰©å¤§ baseSizeï¼Œçœ‹æ‰©å¤§ä»¥åæ˜¯å¦æ»¡è¶³å­å¸ƒå±€çš„è¦æ±‚</span>                baseSize <span class="token operator">=</span> <span class="token punctuation">(</span>baseSize<span class="token operator">+</span>desiredWindowWidth<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>                childWidthMeasureSpec <span class="token operator">=</span> <span class="token function">getRootMeasureSpec</span><span class="token punctuation">(</span>baseSize<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>width<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>privateFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// ç¬¬äºŒæ¬¡æµ‹é‡</span>                <span class="token function">performMeasure</span><span class="token punctuation">(</span>childWidthMeasureSpec<span class="token punctuation">,</span> childHeightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">.</span><span class="token function">getMeasuredWidthAndState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">MEASURED_STATE_TOO_SMALL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    goodMeasure <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>goodMeasure<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// ä¸º rootView ç”Ÿæˆ MeasureSpec</span>        <span class="token comment">// desiredWindowWidthï¼šèƒ½ç»™ rootView åˆ†é…çš„æœ€å¤§å®½åº¦</span>        <span class="token comment">// lp/widthï¼šrootView æœŸæœ›çš„å®½åº¦</span>        childWidthMeasureSpec <span class="token operator">=</span> <span class="token function">getRootMeasureSpec</span><span class="token punctuation">(</span>desiredWindowWidth<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>width<span class="token punctuation">,</span>                                                   lp<span class="token punctuation">.</span>privateFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>        childHeightMeasureSpec <span class="token operator">=</span> <span class="token function">getRootMeasureSpec</span><span class="token punctuation">(</span>desiredWindowHeight<span class="token punctuation">,</span> lp<span class="token punctuation">.</span>height<span class="token punctuation">,</span>                                                    lp<span class="token punctuation">.</span>privateFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>forRootSizeOnly <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">setMeasuredRootSizeFromSpec</span><span class="token punctuation">(</span>            childWidthMeasureSpec<span class="token punctuation">,</span> childHeightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// ç¬¬ä¸‰æ¬¡æµ‹é‡</span>            <span class="token function">performMeasure</span><span class="token punctuation">(</span>childWidthMeasureSpec<span class="token punctuation">,</span> childHeightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// rootView æµ‹é‡å‡ºçš„å®½é«˜å’Œå®é™…å®½é«˜ä¸ä¸€è‡´ï¼Œéœ€è¦é‡æ–°ç¡®å®š window çš„å¤§å°</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mWidth <span class="token operator">!=</span> host<span class="token punctuation">.</span><span class="token function">getMeasuredWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> mHeight <span class="token operator">!=</span> host<span class="token punctuation">.</span><span class="token function">getMeasuredHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            windowSizeMayChange <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> windowSizeMayChange<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œä¸Šè¿°è¿‡ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æµ‹é‡ rootView çš„å°ºå¯¸è¿›è€Œç¡®å®š window çš„å°ºå¯¸ï¼Œæœ€å¤šå¯èƒ½ä¼šç»è¿‡ 3 æ¬¡æµ‹é‡ï¼š</p><ol><li>ç”¨é¢„ç•™çš„å°ºå¯¸æµ‹é‡ viewTreeï¼Œå¦‚æœé¢„ç•™çš„å°ºå¯¸ä¸å¤Ÿï¼Œåˆ™è¿›è¡Œç¬¬äºŒæ¬¡ï¼›</li><li>æ‰©å¤§é¢„ç•™å°ºå¯¸ï¼Œå¤§å°ä¸º <code>(baseSize+desiredWindowWidth)/2</code> è¿›è¡Œç¬¬äºŒæ¬¡æµ‹é‡ï¼Œè‹¥å°ºå¯¸ä¾æ—§ä¸å¤Ÿï¼Œåˆ™è¿›è¡Œç¬¬ä¸‰æ¬¡ï¼›</li><li>ç”¨ window èƒ½æä¾›çš„æœ€å¤§å°ºå¯¸è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœä»æ˜¯ä¸å¤Ÿï¼Œåˆ™æ ‡è®°éœ€è¦é‡æ–°ç¡®å®š window çš„å¤§å°ï¼›</li></ol><p>åœ¨ç¡®å®š window å’Œ rootView çš„å°ºå¯¸ä»¥åï¼Œéœ€è¦ç¡®å®š viewTree ä¸­çš„å„ä¸ª view çš„å°ºå¯¸äº†ã€‚</p><p>é‚£ä¹ˆç»§ç»­å¾€ä¸‹çœ‹ï¼Œ<code>performMeasure()</code> æœ€ç»ˆä¼šè°ƒç”¨å„ä¸ªå­ view çš„ <code>measure()</code> ï¼Œé‚£ä¹ˆä¸€å®šä¼šæ‰§è¡Œ <code>onMeasure()</code> å—ï¼Ÿ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// View.class</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">measure</span><span class="token punctuation">(</span><span class="token keyword">int</span> widthMeasureSpec<span class="token punctuation">,</span> <span class="token keyword">int</span> heightMeasureSpec<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// éœ€è¦å¼ºåˆ¶ layout</span>    <span class="token keyword">final</span> <span class="token keyword">boolean</span> forceLayout <span class="token operator">=</span> <span class="token punctuation">(</span>mPrivateFlags <span class="token operator">&amp;</span> <span class="token constant">PFLAG_FORCE_LAYOUT</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">PFLAG_FORCE_LAYOUT</span><span class="token punctuation">;</span>    <span class="token comment">// å°ºå¯¸å‘ç”Ÿæ”¹å˜</span>    <span class="token keyword">final</span> <span class="token keyword">boolean</span> needsLayout <span class="token operator">=</span> specChanged        <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>sAlwaysRemeasureExactly <span class="token operator">||</span> <span class="token operator">!</span>isSpecExactly <span class="token operator">||</span> <span class="token operator">!</span>matchesSpecSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>forceLayout <span class="token operator">||</span> needsLayout<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// measure ourselves, this should set the measured dimension flag back</span>        <span class="token function">onMeasure</span><span class="token punctuation">(</span>widthMeasureSpec<span class="token punctuation">,</span> heightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ <code>measure()</code> ä¸­å½“æ»¡è¶³ <code>forceLayout || needLayout</code> æ—¶å°±ä¼šè°ƒç”¨ <code>onMeasure()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†æè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¦ä¸º trueã€‚</p><ul><li>forceLayoutï¼šåœ¨ç¬¬ä¸€æ¬¡ measure æ—¶æ²¡æœ‰ç»è¿‡ layout è¿‡ç¨‹ï¼Œè€Œ PFLAG_FORCE_LAYOUT æ ‡è®°æ˜¯åœ¨ layout ç»“æŸä¹‹åæ‰ä¼šæ¸…é™¤ï¼Œæ‰€ä»¥ forceLayout ä¸ºtrueï¼›</li><li>needLayoutï¼šåªæœ‰å°ºå¯¸æ”¹å˜æ—¶ï¼ŒneedLayout æ‰ä¼šä¸º trueï¼Œæ‰€ä»¥éœ€è¦è§†æƒ…å†µè€Œå®šï¼›</li></ul><p>è‡³æ­¤ï¼Œmeasure çš„æºç æµç¨‹å·²ç»åˆ†æå®Œäº†ï¼Œç°åœ¨å›ç­”æ ‡é¢˜æå‡ºçš„é—®é¢˜ã€‚</p><h5 id="ä¸ºä»€ä¹ˆ-onMeasure-ä¼šæ‰§è¡Œä¸¤æ¬¡å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-onMeasure-ä¼šæ‰§è¡Œä¸¤æ¬¡å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ onMeasure() ä¼šæ‰§è¡Œä¸¤æ¬¡å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ onMeasure() ä¼šæ‰§è¡Œä¸¤æ¬¡å‘¢ï¼Ÿ</h5><p>åœ¨ä¸€èˆ¬è§†å›¾è¯¦æƒ…ä¸‹ï¼ŒdecorView ä½œä¸º rootViewï¼Œå…¶ <code>lp.width == ViewGroup.LayoutParams.MATCH_PARENT</code> ï¼Œæ‰€ä»¥ä¸ä¼šèµ°  <code>measureHierarchy()</code> ä¸­çš„å‰ä¸¤æ¬¡ <code>performMeasure()</code> ï¼Œåªä¼šèµ°ç¬¬ä¸‰æ¬¡ï¼Œå†åŠ ä¸Šç¡®å®š rootView ä»¥åæµ‹é‡ viewTree çš„ä¸€æ¬¡ measure å°±æ˜¯ 2 æ¬¡äº†ã€‚ç»“è®ºä¸ºï¼šç¬¬ä¸€æ¬¡ measure ä¸ºç¡®å®š rootView è¿›è€Œç¡®å®š window çš„å¤§å°ï¼Œç¬¬äºŒæ¬¡ measure åˆ™æ˜¯ç¡®å®š viewTree ä¸­å­ view çš„å¤§å°ã€‚ç›¸åº”çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® LayoutParams æ¥è®© <code>onMeasure()</code> æ‰§è¡Œæ¬¡æ•°å¤§äº 2 æ¬¡ï¼Œåœ¨çŸ¥æ™“åŸç†ä»¥åå°±å¾ˆå®¹æ˜“æ“ä½œäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> view </tag>
            
            <tag> æºç è§£æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº±é›¾æ•™ä½ ä¸‹è½½ android æºç </title>
      <link href="/2023/10/22/framework-source-code/"/>
      <url>/2023/10/22/framework-source-code/</url>
      
        <content type="html"><![CDATA[<p>å­¦ä¹  Android ä¸èƒ½ç¦»å¼€æºç ï¼Œä½†æ˜¯ Android æºç å¤ªè¿‡äºåºå¤§ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©åªä¸‹è½½ Framework å±‚çš„æºç ï¼Œå¤§å°åªæœ‰ 900MBï¼Œä¹Ÿå¯ä»¥æ»¡è¶³å­¦ä¹ éœ€è¦ã€‚</p><p>ç”±äºå®˜æ–¹ä¸‹è½½éœ€è¦é­”æ³•ï¼Œä¸”é€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰€ä»¥é€‰æ‹©å›½å†…çš„é•œåƒè¿›è¡Œä¸‹è½½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone git://mirrors.ustc.edu.cn/aosp/platform/frameworks/base <span class="token parameter variable">--depth</span><span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šè¿°é€‰æ‹©ä¸­ç§‘å¤§çš„é•œåƒè¿›è¡Œä¸‹è½½ï¼Œâ€“depth&#x3D;1 æŒ‡åªä¸‹è½½æœ€åä¸€æ¬¡ commit ä¹‹åçš„å†…å®¹ï¼Œä¸ä¼šä¸‹è½½å†å²æäº¤è®°å½•ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ä¸‹è½½è¿‡å¤šèµ„æºï¼Œä½†æ˜¯ä»£ç åªå¯ä»¥æŸ¥çœ‹ï¼Œä¸èƒ½æäº¤åˆ° githubä¸Šã€‚</p><p>å¯¹æ¯”ä¸­ç§‘å¤§ä¸Šä¼ é•œåƒæºçš„æ—¶é—´ï¼ˆ2020å¹´11æœˆï¼‰ï¼Œå¯ä»¥åˆ¤æ–­å‡ºè¿™ä»½ä»£ç æ˜¯ Android 11 ç‰ˆæœ¬çš„ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç ä¸‹è½½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ 367 åœºå‘¨èµ›è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2023/10/16/weekly-contest-367/"/>
      <url>/2023/10/16/weekly-contest-367/</url>
      
        <content type="html"><![CDATA[<h5 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h5><p>å‚åŠ å‘¨èµ› 2 ä¸ªæœˆä»¥æ¥ç¬¬ä¸€æ¬¡ AKï¼Œè¿˜æœ‰æœ‰ç‚¹æ¿€åŠ¨çš„ï¼Œå³ä¾¿è¿™åœºæ˜¯æ‰‹é€Ÿåœºæ€»å…±æœ‰ 600 å¤šäººéƒ½ AK äº†ã€‚è¿™åœºçš„ T4 çš„è§£æ³•åˆšå¥½æ˜¯ä¹‹å‰åšè¿‡çš„é¢˜ï¼Œæ‰€ä»¥èƒ½ AK ä¹Ÿæœ‰è¿æ°”æˆåˆ†åœ¨é‡Œé¢ï¼Œä¸è¿‡ç»§ç»­åŠ æ²¹å­ã€‚</p><p>PSï¼šä»¥åä¸èƒ½éšä¾¿æäº¤ç­”æ¡ˆäº†QAQï¼Œwa äº† 7 æ¬¡å•Šï¼Œç½šäº† 35 åˆ†é’Ÿï¼Œè¿™è°é¡¶å¾—ä½å•Šï¼</p><p><img src="https://s2.loli.net/2023/10/23/nmlCRcpqZDjoi5H.jpg"></p><h5 id="T1-æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡-I"><a href="#T1-æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡-I" class="headerlink" title="T1. æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡ I"></a><a href="https://leetcode.cn/contest/weekly-contest-367/problems/find-indices-with-index-and-value-difference-i/">T1. æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡ I</a></h5><p>åŒ T3</p><h5 id="T2-æœ€çŸ­ä¸”å­—å…¸åºæœ€å°çš„ç¾ä¸½å­å­—ç¬¦ä¸²"><a href="#T2-æœ€çŸ­ä¸”å­—å…¸åºæœ€å°çš„ç¾ä¸½å­å­—ç¬¦ä¸²" class="headerlink" title="T2. æœ€çŸ­ä¸”å­—å…¸åºæœ€å°çš„ç¾ä¸½å­å­—ç¬¦ä¸²"></a><a href="https://leetcode.cn/contest/weekly-contest-367/problems/shortest-and-lexicographically-smallest-beautiful-string/">T2. æœ€çŸ­ä¸”å­—å…¸åºæœ€å°çš„ç¾ä¸½å­å­—ç¬¦ä¸²</a></h5><p>æ•°æ®é‡è¾ƒå°ï¼Œå¯ä»¥æš´åŠ›ä¹Ÿå¯ä»¥æ»‘åŠ¨çª—å£ï¼Œä»¥ä¸‹ä¸ºæ»‘åŠ¨çª—å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">shortestBeautifulSubstring</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s <span class="token operator">=</span> <span class="token class-name">S</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> ans <span class="token operator">=</span> <span class="token class-name">S</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cnt1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> right <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> right<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cnt1 <span class="token operator">+=</span> s<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt1 <span class="token operator">></span> k <span class="token operator">||</span> s<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cnt1 <span class="token operator">-=</span> s<span class="token punctuation">[</span>left<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt1 <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> t <span class="token operator">=</span> <span class="token class-name">S</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> ans<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> t<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> ans<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    ans <span class="token operator">=</span> t<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T3-æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡II"><a href="#T3-æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡II" class="headerlink" title="T3.æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡II"></a><a href="https://leetcode.cn/contest/weekly-contest-367/problems/find-indices-with-index-and-value-difference-ii/">T3.æ‰¾å‡ºæ»¡è¶³å·®å€¼æ¡ä»¶çš„ä¸‹æ ‡II</a></h5><p>ç»´æŠ¤æœ€å¤§å€¼å’Œæœ€å°å€¼çš„ä¸‹æ ‡</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findIndices</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> indexDifference<span class="token punctuation">,</span> <span class="token keyword">int</span> valueDifference<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> maxIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> minIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> indexDifference<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> i <span class="token operator">=</span> j <span class="token operator">-</span> indexDifference<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>maxIdx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                maxIdx <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>minIdx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                minIdx <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>maxIdx<span class="token punctuation">]</span> <span class="token operator">-</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>=</span> valueDifference<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>maxIdx<span class="token punctuation">,</span> j<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> nums<span class="token punctuation">[</span>minIdx<span class="token punctuation">]</span> <span class="token operator">>=</span> valueDifference<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>minIdx<span class="token punctuation">,</span> j<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="T4-æ„é€ ä¹˜ç§¯çŸ©é˜µ"><a href="#T4-æ„é€ ä¹˜ç§¯çŸ©é˜µ" class="headerlink" title="T4. æ„é€ ä¹˜ç§¯çŸ©é˜µ"></a><a href="https://leetcode.cn/contest/weekly-contest-367/problems/construct-product-matrix/">T4. æ„é€ ä¹˜ç§¯çŸ©é˜µ</a></h5><p>åŒ <a href="https://leetcode.cn/problems/product-of-array-except-self/description/">é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</a>ï¼Œåªä¸è¿‡æ•°æ®ç”±ä¸€ç»´å˜ä¸ºäºŒç»´</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">constructProductMatrix</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MOD</span> <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">,</span> m <span class="token operator">=</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> suf <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> suf<span class="token punctuation">;</span>                suf <span class="token operator">=</span> suf <span class="token operator">*</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token constant">MOD</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> pre <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> pre <span class="token operator">%</span> <span class="token constant">MOD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                pre <span class="token operator">=</span> pre <span class="token operator">*</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token constant">MOD</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> p<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LCå‘¨èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å‘¨èµ›æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº±é›¾ã®å•ä¾‹æ¨¡å¼å­¦ä¹ ç¬”è®°</title>
      <link href="/2023/10/15/singleton/"/>
      <url>/2023/10/15/singleton/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</h4><p>å•ä¾‹æ¨¡å¼æŒ‡ä¸€ä¸ªç±»åœ¨ä»»ä½•æ—¶å€™éƒ½åº”è¯¥åªæœ‰ä¸€ä¸ªå®ä¾‹åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”ä»¥ <strong>static</strong> çš„æ–¹å¼æä¾›ç»™æ•´ä¸ªé¡¹ç›®è¿›è¡Œè®¿é—®ã€‚</p><p>ä»¥ä¸‹æä¾›å‡ ç§å•ä¾‹æ¨¡å¼çš„ä¹¦å†™æ–¹æ³•ï¼š</p><h5 id="1-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#1-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="1.é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"></a>1.é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> mInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> mInstance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä¼˜ç‚¹ï¼šä¸éœ€è¦ä¸Šé”ï¼Œä»æ€§èƒ½è§’åº¦æ¥çœ‹æ›´å¥½</li><li>ç¼ºç‚¹ï¼šä»ç±»åŠ è½½æ—¶å°±å¼€å§‹åˆå§‹åŒ–å¯¹è±¡ï¼Œåœ¨ä¸éœ€è¦ä½¿ç”¨æ—¶å°±å ç”¨äº†å†…å­˜ç©ºé—´</li></ul><h5 id="2-æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#2-æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="2.æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"></a>2.æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> mInstance<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>mInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    mInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> mInstance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼åˆç§°ä¸º DCLï¼ˆdouble check lockingï¼‰å•ä¾‹æ¨¡å¼ï¼Œå³ä¸ºåŒé‡é”å®šæ£€æŸ¥ã€‚</p><p><strong>é‚£ä¹ˆè¿™ç§åˆ¤å®šå°±çœŸçš„å®‰å…¨å—ï¼Ÿ</strong></p><p>å¦‚ä¸‹å›¾æ˜¯ getInstance() æ–¹æ³•å¯¹åº”çš„å­—èŠ‚ç ï¼š</p><p><img src="https://s2.loli.net/2023/10/13/8THmPDaQ4qlXkpN.png"></p><p>å…¶ä¸­é‡è¦çš„å‡ è¡Œå«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬17è¡Œï¼šç”³è¯·å†…å­˜ç©ºé—´ï¼Œä½†æ­¤æ—¶å¹¶æ²¡æœ‰è°ƒç”¨æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥å†…å­˜ä¸­éƒ½æ˜¯é»˜è®¤å€¼</li><li>ç¬¬21è¡Œï¼šæ‰§è¡Œæ„é€ æ–¹æ³•</li><li>ç¬¬32è¡Œï¼šå°†æ ˆä¸­çš„å¯¹è±¡å’Œå †ä¸­çš„å¯¹è±¡å»ºç«‹å…³è”</li></ul><p>ä½†æ˜¯åœ¨cpuæ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼ŒæŒ‡ä»¤çš„é¡ºåºå¹¶ä¸æ˜¯å®Œå…¨å›ºå®šçš„ï¼Œå‡å¦‚ç¬¬11è¡Œå’Œç¬¬16è¡Œé¡ºåºäº’æ¢ï¼Œå³å‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åºï¼Œåœ¨å•çº¿ç¨‹æƒ…å†µä¸‹ä¸å½±å“æœ€ç»ˆçš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹å°±ä¼šå‡ºç°æ„å‘ä¸åˆ°çš„é—®é¢˜ï¼Œä¸”å¬å¦‚ä¸‹åˆ†æï¼š</p><p>ç°æœ‰ A çº¿ç¨‹å¼€å§‹æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œç”±äºç¬¬ä¸€ä¸ªåˆ¤ç©ºæœªåŠ é”ï¼ŒA çº¿ç¨‹å¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œåœ¨ä¸‹ä¸€è¡Œ A çº¿ç¨‹æ‹¿åˆ°äº†é”èµ„æºï¼Œå¼€å§‹åˆ›å»ºå¯¹è±¡ï¼Œå…ˆæ‰§è¡Œäº†ç¬¬ 17 è¡ŒæŒ‡ä»¤ç”³è¯·äº†å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯ç¬¬ 21 è¡Œå’Œç¬¬ 32 è¡ŒæŒ‡ä»¤å‘ç”Ÿäº†é‡æ’ï¼Œastore_1 å…ˆå’Œå †ä¸­å¯¹è±¡å»ºç«‹äº†å…³è”ï¼Œè€Œæ°å¥½æ­¤æ—¶çº¿ç¨‹ B å¼€å§‹æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œåœ¨ç¬¬ä¸€è¡Œåˆ¤ç©ºæ—¶ç›´æ¥è¿”å› falseï¼Œçº¿ç¨‹ B å°±è·å–åˆ°äº†æœªåˆå§‹åŒ–çš„å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œæ“ä½œå°±å¯èƒ½ä¼šæŠ¥é”™ã€‚</p><p><strong>å¦‚æœå°† synchronized å…³é”®å­—åŠ è½½æ–¹æ³•ç»´åº¦å‘¢ï¼Ÿ</strong></p><p>çš„ç¡®ï¼Œè¿™æ ·çš„è¯ä¸ä¼šå‡ºç°ä¸Šè¿°æŠ¥é”™ï¼Œä½†æ˜¯å¦‚æœéœ€è¦åœ¨æ–¹æ³•å†…æ‰§è¡Œä¸€äº›è€—æ—¶æ“ä½œï¼Œæ¯”å¦‚ä» db ä¸­è¯»å–æ•°æ®çš„ä¸šåŠ¡é€»è¾‘å°±æ²¡æœ‰å¿…è¦ä¸Šé”ï¼Œæ‰€ä»¥ä¸ºäº†è®©é”çš„ç²’åº¦å˜å°ä¸€ç‚¹ï¼Œè®©å¯æ‰§è¡Œçš„æ—¶é—´æ•ˆç‡é«˜ä¸€ç‚¹ï¼Œåˆ™ä¸ä¼šç»™æ•´ä¸ªæ–¹æ³•ä¸Šé”ã€‚</p><p>æœ‰æ„æ€çš„æ˜¯ï¼Œåœ¨å†™å‡º DCL å•ä¾‹æ¨¡å¼ä»¥åï¼ŒIDEA ä¼šé«˜äº®æç¤ºæ”¹ä¸ºé™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><p><img src="https://s2.loli.net/2023/10/13/f3z547Ah6UMWLSi.png"></p><h5 id="3-é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"><a href="#3-é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼" class="headerlink" title="3.é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"></a>3.é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHolder</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> mInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">SingletonHolder</span><span class="token punctuation">.</span>mInstance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼çš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p><p>ä¸ DCL æ¨¡å¼ä¸åŒï¼ŒgetInstance() å¹¶æ²¡æœ‰å¤šæ¬¡å» new å¯¹è±¡ï¼Œæ•…ä¸ç®¡å¤šå°‘ä¸ªçº¿ç¨‹å»è°ƒç”¨ getInstance() æ–¹æ³•ï¼Œå–çš„éƒ½æ˜¯åŒä¸€ä¸ª mInstance å¯¹è±¡ï¼Œè€Œä¸ç”¨é‡æ–°åˆ›å»ºã€‚å¤–éƒ¨ç±»åŠ è½½æ—¶å¹¶ä¸éœ€è¦ç«‹å³åŠ è½½å†…éƒ¨ç±»ï¼Œåªæœ‰å½“ getInstance() æ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼ŒSingletonHolder æ‰åœ¨ Singleton çš„è¿è¡Œæ—¶å¸¸é‡æ± é‡Œï¼ŒæŠŠç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œè™šæ‹Ÿæœºæ‰ä¼šå»åŠ è½½ SingletonHolder ç±»ï¼Œæ‰ä¼šå»åˆå§‹åŒ– mInstanceï¼Œè¿™ç§æ–¹æ³•ä¸ä½†èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯å•ä¾‹çš„å”¯ä¸€æ€§ï¼ŒåŒæ—¶ä¹Ÿå»¶è¿Ÿäº†å•ä¾‹çš„å®ä¾‹åŒ–ã€‚</p><p><strong>é‚£ä¹ˆåœ¨åˆ›å»ºæ—¶åˆæ˜¯æ€ä¹ˆä¿è¯çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿ</strong></p><p>è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„ &lt;clinit&gt;() æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åœ°åŠ é”ã€åŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„ &lt;clinit&gt;() æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³•å®Œæ¯•ã€‚</p><p><strong>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼çœŸçš„å®Œç¾æ— ç¼ºå—ï¼Ÿ</strong></p><p>å¦‚ä¸Šåˆ†æï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹æ˜¯æ— æ³•å°†å¤–éƒ¨å‚æ•°ä¼ é€’è¿›å»çš„ï¼Œä¾‹å¦‚æœ€å¸¸ç”¨çš„ Context å‚æ•°ï¼Œæ‰€ä»¥åœ¨é€‰æ‹©å•ä¾‹æ¨¡å¼æ—¶éœ€è¦ä¾æ®ä¸šåŠ¡åœºæ™¯æ¥è¿›è¡ŒæŠ‰æ‹©ã€‚</p><h5 id="4-ä¼˜åŒ–åçš„-DCL-æ¨¡å¼"><a href="#4-ä¼˜åŒ–åçš„-DCL-æ¨¡å¼" class="headerlink" title="4.ä¼˜åŒ–åçš„ DCL æ¨¡å¼"></a>4.ä¼˜åŒ–åçš„ DCL æ¨¡å¼</h5><p>å¦‚ä¸Šåˆ†æï¼Œæ¯ç§å•ä¾‹æ¨¡å¼éƒ½æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ç›¸å¯¹æœ€ç»¼åˆçš„å•ä¾‹æ¨¡å¼å‘¢ï¼Ÿ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">Singleton</span> mInstance<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>mInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    mInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> mInstance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªéœ€è¦åœ¨ mInstance å‰åŠ ä¸Š volatile å…³é”®å­—å³å¯ã€‚</p><p>volatile å…³é”®å­—ä¿è¯åœ¨å¤šçº¿ç¨‹å¹¶å‘æ“ä½œçš„æƒ…å†µä¸‹ï¼Œè®¿é—®çš„æ˜¯ä¸»å†…å­˜ä¸­çš„æ•°æ®ä¿¡æ¯ï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºå¹¶å‘æ‰§è¡Œå¯¼è‡´è·å–ä¸åˆ°æœ€æ–°æ•°æ®ä¿¡æ¯çš„é”™è¯¯æƒ…å†µå‘ç”Ÿäº†ã€‚</p><p>å¹¶ä¸”ï¼Œä¾‹å¦‚ Glideã€EventBus ç­‰è‘—åçš„åº“éƒ½æ˜¯ä½¿ç”¨è¿™ç§å•ä¾‹æ¨¡å¼ï¼Œè¶³è§å…¶å¯é æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½å›¾æ˜¯ä»€ä¹ˆé»‘é­”æ³•å‘¢</title>
      <link href="/2023/10/15/bitset/"/>
      <url>/2023/10/15/bitset/</url>
      
        <content type="html"><![CDATA[<h3 id="ä½å›¾çš„åŸç†"><a href="#ä½å›¾çš„åŸç†" class="headerlink" title="ä½å›¾çš„åŸç†"></a>ä½å›¾çš„åŸç†</h3><hr><p>ä½å›¾ä¹Ÿè¢«ç§°ä¸º bitmap æˆ– bitsetï¼Œæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œ<strong>ç”¨ bit çŠ¶æ€ 1ã€0 ä»£è¡¨å­˜åœ¨ã€ä¸å­˜åœ¨</strong>ï¼Œå–å€¼å’Œå­˜å€¼æ“ä½œéƒ½ç”¨ä½è¿ç®—ï¼Œå¹¶ä¸”æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚</p><p>ä½å›¾çš„ä½¿ç”¨å­˜åœ¨ä¸€å®šæ˜¯é™åˆ¶ï¼Œæ•°æ®å¿…é¡»<strong>æœ‰ä¸€å®šçš„è¿ç»­æ€§ï¼Œå¹¶ä¸”èŒƒå›´ä¸èƒ½å¤ªå¤§</strong>ã€‚å¥½å¤„æ˜¯æå¤§çš„èŠ‚çœç©ºé—´ï¼Œå› ä¸º 1 ä¸ªæ•°å­—åªå ç”¨ 1 ä¸ª bit çš„ç©ºé—´ã€‚</p><h3 id="ä½å›¾çš„å®ç°"><a href="#ä½å›¾çš„å®ç°" class="headerlink" title="ä½å›¾çš„å®ç°"></a>ä½å›¾çš„å®ç°</h3><hr><p>é’ˆå¯¹ä½å›¾ï¼Œéœ€è¦æä¾›ä»¥ä¸‹å‡ ç§åŸºæœ¬æ“ä½œï¼š</p><ul><li>bitset (int n)ï¼šåˆå§‹åŒ–ä½å›¾çš„å¤§å°ï¼Œåªæ”¯æŒ 0 ~ n-1 æ‰€æœ‰æ•°å­—çš„å¢åˆ æ”¹æŸ¥ï¼›</li><li>void add (int num)ï¼šæŠŠ num åŠ å…¥åˆ°ä½å›¾ï¼›</li><li>void remove (int num)ï¼šæŠŠ num ä»ä½å›¾ä¸­åˆ é™¤ï¼›</li><li>void reverse (int num)ï¼šå¦‚æœä½å›¾é‡Œæ²¡æœ‰ numï¼Œå°±åŠ å…¥ï¼›å¦‚æœä½å›¾é‡Œæœ‰ numï¼Œå°±åˆ é™¤ï¼›</li><li>boolean contains (int num)ï¼šæŸ¥è¯¢ num æ˜¯å¦åœ¨ä½å›¾ï¼›</li></ul><p>åœ¨éœ€è¦åœ¨æœ¬åœ°éªŒè¯æ­£ç¡®æ€§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¯¹æ•°å™¨ï¼Œå‚ç…§ç±»å‹ä¸º HashSetã€‚</p><p>ä»¥ä¸‹æ˜¯å®ç°ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Bitset</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> set<span class="token punctuation">;</span>    <span class="token comment">// å¤§å°ä¸º n ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºèŒƒå›´ä¸º 0 ~ n-1</span>    <span class="token keyword">public</span> <span class="token class-name">Bitset</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å¦‚æœæƒ³æ±‚ a/b å¹¶ä¸”å‘ä¸Šå–æ•´ï¼Œåœ¨ a å’Œ b éƒ½éè´Ÿçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å†™ä¸º (a+b-1)/b</span>        set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * add(int num)ï¼šå°† num æ‰€å±çš„é‚£ä¸€ä½ bit ç½®ä¸º 1     * num/32ï¼šæ±‚å‡º num åœ¨ set æ•°ç»„ä¸­çš„ä¸‹æ ‡     * num%32ï¼šæ±‚å‡º num åœ¨ set[num/32] ä¸­å±äºç¬¬å‡ ä½     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        set<span class="token punctuation">[</span>num <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * remove(int num)ï¼šå°† num æ‰€å±çš„é‚£ä¸€ä½ bit ç½®ä¸º 0     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        set<span class="token punctuation">[</span>num <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * reverse(int num)ï¼šå¦‚æœ num æ‰€å±ä½ç½®çš„ bit ä¸º 1ï¼Œåˆ™ç½®ä¸º 0ï¼Œè‹¥ä¸º 0ï¼Œåˆ™ç½®ä¸º 1     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        set<span class="token punctuation">[</span>num <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * contains(int num)ï¼šåˆ¤æ–­ num æ‰€å±ä½ç½®çš„ bit æ˜¯å¦ä¸º 1     */</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>set<span class="token punctuation">[</span>num <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éªŒè¯å®ç°æ˜¯å¦æ­£ç¡®ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">// æ•°æ®èŒƒå›´ä¸º 0 ~ 999</span>    <span class="token keyword">int</span> testTimes <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span class="token comment">// æµ‹è¯•æ¬¡æ•°ä¸º 10000æ¬¡</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•å¼€å§‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Bitset</span> bitSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bitset</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®ç°çš„ä½å›¾ç»“æ„</span>    <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> hashSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨HashSetåšå¯¹æ¯”æµ‹è¯•</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒç”¨é˜¶æ®µå¼€å§‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å¯¹ bitset å’Œ hashset æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œæ‰§è¡Œ 10000 æ¬¡ä»¥åï¼Œé€šè¿‡contains(num)åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸€è‡´</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> testTimes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">double</span> decide <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// number -> 0 ~ n-1ï¼Œç­‰æ¦‚ç‡å¾—åˆ°</span>        <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>decide <span class="token operator">&lt;</span> <span class="token number">0.333</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            bitSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>            hashSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>decide <span class="token operator">&lt;</span> <span class="token number">0.666</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            bitSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>            hashSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            bitSet<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>hashSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                hashSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                hashSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒç”¨é˜¶æ®µç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"éªŒè¯é˜¶æ®µå¼€å§‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bitSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> hashSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‡ºé”™äº†!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"éªŒè¯é˜¶æ®µç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•ç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
